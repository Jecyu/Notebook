<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>设计模式 | Naluduo&#39;s Notebook</title>
    <meta name="generator" content="VuePress 1.5.0">
    <link rel="icon" href="/Notebook/images/logo.jpeg">
    <meta name="description" content="📝每天记录一点点">
    <link rel="preload" href="/Notebook/assets/css/0.styles.8f4327af.css" as="style"><link rel="preload" href="/Notebook/assets/js/app.139a155b.js" as="script"><link rel="preload" href="/Notebook/assets/js/4.e8b70bd9.js" as="script"><link rel="preload" href="/Notebook/assets/js/24.84834785.js" as="script"><link rel="prefetch" href="/Notebook/assets/js/10.1fae0c9b.js"><link rel="prefetch" href="/Notebook/assets/js/100.d0da51c4.js"><link rel="prefetch" href="/Notebook/assets/js/101.f5af623a.js"><link rel="prefetch" href="/Notebook/assets/js/102.b3d42b74.js"><link rel="prefetch" href="/Notebook/assets/js/103.8f17785a.js"><link rel="prefetch" href="/Notebook/assets/js/104.056d18e2.js"><link rel="prefetch" href="/Notebook/assets/js/105.50f362f2.js"><link rel="prefetch" href="/Notebook/assets/js/106.2293abd8.js"><link rel="prefetch" href="/Notebook/assets/js/107.776d74d9.js"><link rel="prefetch" href="/Notebook/assets/js/108.562a5345.js"><link rel="prefetch" href="/Notebook/assets/js/109.9897ab89.js"><link rel="prefetch" href="/Notebook/assets/js/11.c1323ed6.js"><link rel="prefetch" href="/Notebook/assets/js/110.5986b585.js"><link rel="prefetch" href="/Notebook/assets/js/111.163a9a13.js"><link rel="prefetch" href="/Notebook/assets/js/112.ab7e15ac.js"><link rel="prefetch" href="/Notebook/assets/js/113.11bd753c.js"><link rel="prefetch" href="/Notebook/assets/js/114.53962168.js"><link rel="prefetch" href="/Notebook/assets/js/115.3a5ada66.js"><link rel="prefetch" href="/Notebook/assets/js/116.cf65da6f.js"><link rel="prefetch" href="/Notebook/assets/js/117.26108558.js"><link rel="prefetch" href="/Notebook/assets/js/118.aa336fda.js"><link rel="prefetch" href="/Notebook/assets/js/119.7ceb5577.js"><link rel="prefetch" href="/Notebook/assets/js/12.4e58256f.js"><link rel="prefetch" href="/Notebook/assets/js/120.4f14c30d.js"><link rel="prefetch" href="/Notebook/assets/js/121.19f5571d.js"><link rel="prefetch" href="/Notebook/assets/js/122.1d0669c3.js"><link rel="prefetch" href="/Notebook/assets/js/123.a7f30f7e.js"><link rel="prefetch" href="/Notebook/assets/js/124.fff11adb.js"><link rel="prefetch" href="/Notebook/assets/js/125.b56646a4.js"><link rel="prefetch" href="/Notebook/assets/js/126.1c59b3bd.js"><link rel="prefetch" href="/Notebook/assets/js/127.fcb506e8.js"><link rel="prefetch" href="/Notebook/assets/js/128.5b580b8f.js"><link rel="prefetch" href="/Notebook/assets/js/129.84ae003a.js"><link rel="prefetch" href="/Notebook/assets/js/13.1c4e6be1.js"><link rel="prefetch" href="/Notebook/assets/js/130.6dcaf514.js"><link rel="prefetch" href="/Notebook/assets/js/131.a42f7c47.js"><link rel="prefetch" href="/Notebook/assets/js/132.04f8a016.js"><link rel="prefetch" href="/Notebook/assets/js/133.57281f84.js"><link rel="prefetch" href="/Notebook/assets/js/134.ecd654d6.js"><link rel="prefetch" href="/Notebook/assets/js/135.63a2dbad.js"><link rel="prefetch" href="/Notebook/assets/js/136.d99e29b3.js"><link rel="prefetch" href="/Notebook/assets/js/137.50d7b01d.js"><link rel="prefetch" href="/Notebook/assets/js/138.4390b86c.js"><link rel="prefetch" href="/Notebook/assets/js/139.2d9ce853.js"><link rel="prefetch" href="/Notebook/assets/js/14.0443782b.js"><link rel="prefetch" href="/Notebook/assets/js/140.4a2047e8.js"><link rel="prefetch" href="/Notebook/assets/js/141.b3704c9c.js"><link rel="prefetch" href="/Notebook/assets/js/142.4d142b47.js"><link rel="prefetch" href="/Notebook/assets/js/143.f15872bb.js"><link rel="prefetch" href="/Notebook/assets/js/144.679f0a2d.js"><link rel="prefetch" href="/Notebook/assets/js/145.2106194a.js"><link rel="prefetch" href="/Notebook/assets/js/146.605f3d79.js"><link rel="prefetch" href="/Notebook/assets/js/147.3682320c.js"><link rel="prefetch" href="/Notebook/assets/js/148.cbcbff7e.js"><link rel="prefetch" href="/Notebook/assets/js/149.c2a26094.js"><link rel="prefetch" href="/Notebook/assets/js/15.de1f84e8.js"><link rel="prefetch" href="/Notebook/assets/js/150.0086324a.js"><link rel="prefetch" href="/Notebook/assets/js/151.5f722522.js"><link rel="prefetch" href="/Notebook/assets/js/152.d3eaf2c8.js"><link rel="prefetch" href="/Notebook/assets/js/153.a1864660.js"><link rel="prefetch" href="/Notebook/assets/js/154.d1ae6046.js"><link rel="prefetch" href="/Notebook/assets/js/155.eb0fccff.js"><link rel="prefetch" href="/Notebook/assets/js/156.9db0381e.js"><link rel="prefetch" href="/Notebook/assets/js/157.0b4984af.js"><link rel="prefetch" href="/Notebook/assets/js/158.43189b18.js"><link rel="prefetch" href="/Notebook/assets/js/159.812f06b9.js"><link rel="prefetch" href="/Notebook/assets/js/16.2ea274b4.js"><link rel="prefetch" href="/Notebook/assets/js/160.1f44d433.js"><link rel="prefetch" href="/Notebook/assets/js/161.21852224.js"><link rel="prefetch" href="/Notebook/assets/js/162.9bb18d96.js"><link rel="prefetch" href="/Notebook/assets/js/163.0d4bb60d.js"><link rel="prefetch" href="/Notebook/assets/js/164.5ddcb334.js"><link rel="prefetch" href="/Notebook/assets/js/165.4c394b31.js"><link rel="prefetch" href="/Notebook/assets/js/166.62ee9f20.js"><link rel="prefetch" href="/Notebook/assets/js/167.3c668713.js"><link rel="prefetch" href="/Notebook/assets/js/168.bae89f34.js"><link rel="prefetch" href="/Notebook/assets/js/169.efed8b05.js"><link rel="prefetch" href="/Notebook/assets/js/17.881f6ab6.js"><link rel="prefetch" href="/Notebook/assets/js/170.3d8e1b73.js"><link rel="prefetch" href="/Notebook/assets/js/171.2c9b4191.js"><link rel="prefetch" href="/Notebook/assets/js/172.7dda8427.js"><link rel="prefetch" href="/Notebook/assets/js/173.ce6698c1.js"><link rel="prefetch" href="/Notebook/assets/js/174.1ee6dc45.js"><link rel="prefetch" href="/Notebook/assets/js/175.77f2eea7.js"><link rel="prefetch" href="/Notebook/assets/js/176.fbb0fa4e.js"><link rel="prefetch" href="/Notebook/assets/js/177.82817bff.js"><link rel="prefetch" href="/Notebook/assets/js/178.616bd587.js"><link rel="prefetch" href="/Notebook/assets/js/179.6dc3a213.js"><link rel="prefetch" href="/Notebook/assets/js/18.0e13bc5c.js"><link rel="prefetch" href="/Notebook/assets/js/180.55c85341.js"><link rel="prefetch" href="/Notebook/assets/js/181.fc3d81b6.js"><link rel="prefetch" href="/Notebook/assets/js/182.8790a49f.js"><link rel="prefetch" href="/Notebook/assets/js/183.22912b56.js"><link rel="prefetch" href="/Notebook/assets/js/184.a3cc6104.js"><link rel="prefetch" href="/Notebook/assets/js/185.8bad0700.js"><link rel="prefetch" href="/Notebook/assets/js/186.9aca737e.js"><link rel="prefetch" href="/Notebook/assets/js/187.1465e2fb.js"><link rel="prefetch" href="/Notebook/assets/js/188.bd29e48b.js"><link rel="prefetch" href="/Notebook/assets/js/189.0d6a0652.js"><link rel="prefetch" href="/Notebook/assets/js/19.a428bfa6.js"><link rel="prefetch" href="/Notebook/assets/js/190.c8ff6ab9.js"><link rel="prefetch" href="/Notebook/assets/js/191.116dc665.js"><link rel="prefetch" href="/Notebook/assets/js/192.3d558a9e.js"><link rel="prefetch" href="/Notebook/assets/js/193.4d856925.js"><link rel="prefetch" href="/Notebook/assets/js/194.85e0627b.js"><link rel="prefetch" href="/Notebook/assets/js/195.ad78bbd6.js"><link rel="prefetch" href="/Notebook/assets/js/196.8c7c9b72.js"><link rel="prefetch" href="/Notebook/assets/js/197.447f0a00.js"><link rel="prefetch" href="/Notebook/assets/js/198.cfabe606.js"><link rel="prefetch" href="/Notebook/assets/js/199.89482b48.js"><link rel="prefetch" href="/Notebook/assets/js/2.17a0eab0.js"><link rel="prefetch" href="/Notebook/assets/js/20.3106c5a5.js"><link rel="prefetch" href="/Notebook/assets/js/200.c186e0f9.js"><link rel="prefetch" href="/Notebook/assets/js/201.b6bfc826.js"><link rel="prefetch" href="/Notebook/assets/js/202.c1f56d61.js"><link rel="prefetch" href="/Notebook/assets/js/203.55fe1aa3.js"><link rel="prefetch" href="/Notebook/assets/js/204.ebd5e2d4.js"><link rel="prefetch" href="/Notebook/assets/js/205.71b72bf6.js"><link rel="prefetch" href="/Notebook/assets/js/206.bd18bc7f.js"><link rel="prefetch" href="/Notebook/assets/js/207.d4d69acd.js"><link rel="prefetch" href="/Notebook/assets/js/208.222b7876.js"><link rel="prefetch" href="/Notebook/assets/js/209.f25452d4.js"><link rel="prefetch" href="/Notebook/assets/js/21.76dba99d.js"><link rel="prefetch" href="/Notebook/assets/js/210.3393aed8.js"><link rel="prefetch" href="/Notebook/assets/js/211.fb8cb7a1.js"><link rel="prefetch" href="/Notebook/assets/js/212.344d00e0.js"><link rel="prefetch" href="/Notebook/assets/js/213.a51629c4.js"><link rel="prefetch" href="/Notebook/assets/js/214.d97e28ee.js"><link rel="prefetch" href="/Notebook/assets/js/215.66576ead.js"><link rel="prefetch" href="/Notebook/assets/js/216.cbd47b9d.js"><link rel="prefetch" href="/Notebook/assets/js/217.115d7a12.js"><link rel="prefetch" href="/Notebook/assets/js/218.d1b6e62f.js"><link rel="prefetch" href="/Notebook/assets/js/219.f2bf2e5f.js"><link rel="prefetch" href="/Notebook/assets/js/22.a03922de.js"><link rel="prefetch" href="/Notebook/assets/js/220.8df2573e.js"><link rel="prefetch" href="/Notebook/assets/js/221.3d8ee874.js"><link rel="prefetch" href="/Notebook/assets/js/222.8a4e6ab3.js"><link rel="prefetch" href="/Notebook/assets/js/223.e8f7051b.js"><link rel="prefetch" href="/Notebook/assets/js/224.f864e8f4.js"><link rel="prefetch" href="/Notebook/assets/js/225.30413761.js"><link rel="prefetch" href="/Notebook/assets/js/226.c2f2286f.js"><link rel="prefetch" href="/Notebook/assets/js/227.d7346a90.js"><link rel="prefetch" href="/Notebook/assets/js/228.6066eeb2.js"><link rel="prefetch" href="/Notebook/assets/js/229.0102fdc3.js"><link rel="prefetch" href="/Notebook/assets/js/23.685dee89.js"><link rel="prefetch" href="/Notebook/assets/js/230.c21b14f8.js"><link rel="prefetch" href="/Notebook/assets/js/231.9165f00e.js"><link rel="prefetch" href="/Notebook/assets/js/232.a7474466.js"><link rel="prefetch" href="/Notebook/assets/js/233.667bd498.js"><link rel="prefetch" href="/Notebook/assets/js/234.b7eb4d16.js"><link rel="prefetch" href="/Notebook/assets/js/235.0edef63f.js"><link rel="prefetch" href="/Notebook/assets/js/236.076754ee.js"><link rel="prefetch" href="/Notebook/assets/js/237.6527bc02.js"><link rel="prefetch" href="/Notebook/assets/js/238.7aa882f3.js"><link rel="prefetch" href="/Notebook/assets/js/239.71ad3f6e.js"><link rel="prefetch" href="/Notebook/assets/js/240.42d36cc0.js"><link rel="prefetch" href="/Notebook/assets/js/241.fba85183.js"><link rel="prefetch" href="/Notebook/assets/js/242.d652773d.js"><link rel="prefetch" href="/Notebook/assets/js/243.dd6c78c5.js"><link rel="prefetch" href="/Notebook/assets/js/244.da300c6d.js"><link rel="prefetch" href="/Notebook/assets/js/245.1ab30248.js"><link rel="prefetch" href="/Notebook/assets/js/246.b1de7d1b.js"><link rel="prefetch" href="/Notebook/assets/js/247.17c60f57.js"><link rel="prefetch" href="/Notebook/assets/js/248.f3e9919e.js"><link rel="prefetch" href="/Notebook/assets/js/249.9b68ff42.js"><link rel="prefetch" href="/Notebook/assets/js/25.9c4dea8d.js"><link rel="prefetch" href="/Notebook/assets/js/250.20e586ab.js"><link rel="prefetch" href="/Notebook/assets/js/251.91974a71.js"><link rel="prefetch" href="/Notebook/assets/js/252.4b90ead2.js"><link rel="prefetch" href="/Notebook/assets/js/253.49a92048.js"><link rel="prefetch" href="/Notebook/assets/js/254.8abd7868.js"><link rel="prefetch" href="/Notebook/assets/js/255.874d4cfe.js"><link rel="prefetch" href="/Notebook/assets/js/256.c42da90b.js"><link rel="prefetch" href="/Notebook/assets/js/257.574a4463.js"><link rel="prefetch" href="/Notebook/assets/js/258.9dfecce5.js"><link rel="prefetch" href="/Notebook/assets/js/259.5fb8371d.js"><link rel="prefetch" href="/Notebook/assets/js/26.de8bed1f.js"><link rel="prefetch" href="/Notebook/assets/js/260.8cb0b9f2.js"><link rel="prefetch" href="/Notebook/assets/js/261.0320ad16.js"><link rel="prefetch" href="/Notebook/assets/js/262.7db236d1.js"><link rel="prefetch" href="/Notebook/assets/js/263.968b439e.js"><link rel="prefetch" href="/Notebook/assets/js/264.50a7aa29.js"><link rel="prefetch" href="/Notebook/assets/js/265.71a06556.js"><link rel="prefetch" href="/Notebook/assets/js/266.6c59b012.js"><link rel="prefetch" href="/Notebook/assets/js/267.aeb43b9d.js"><link rel="prefetch" href="/Notebook/assets/js/268.a2929ce6.js"><link rel="prefetch" href="/Notebook/assets/js/269.26707ae0.js"><link rel="prefetch" href="/Notebook/assets/js/27.23c0d0bb.js"><link rel="prefetch" href="/Notebook/assets/js/270.b8610d2f.js"><link rel="prefetch" href="/Notebook/assets/js/271.bda5e283.js"><link rel="prefetch" href="/Notebook/assets/js/272.e49151e7.js"><link rel="prefetch" href="/Notebook/assets/js/273.4cfeb2d1.js"><link rel="prefetch" href="/Notebook/assets/js/274.60fe8724.js"><link rel="prefetch" href="/Notebook/assets/js/275.b5514094.js"><link rel="prefetch" href="/Notebook/assets/js/276.202e3526.js"><link rel="prefetch" href="/Notebook/assets/js/277.26e46a71.js"><link rel="prefetch" href="/Notebook/assets/js/278.1c447532.js"><link rel="prefetch" href="/Notebook/assets/js/279.0b5e7a7b.js"><link rel="prefetch" href="/Notebook/assets/js/28.6f6d2ce9.js"><link rel="prefetch" href="/Notebook/assets/js/280.ba75d1ae.js"><link rel="prefetch" href="/Notebook/assets/js/281.b38f3748.js"><link rel="prefetch" href="/Notebook/assets/js/282.40c8513b.js"><link rel="prefetch" href="/Notebook/assets/js/283.a9392d6d.js"><link rel="prefetch" href="/Notebook/assets/js/284.d27a365f.js"><link rel="prefetch" href="/Notebook/assets/js/285.a628a15e.js"><link rel="prefetch" href="/Notebook/assets/js/286.fd9e7c31.js"><link rel="prefetch" href="/Notebook/assets/js/287.7a9f259d.js"><link rel="prefetch" href="/Notebook/assets/js/288.739670c2.js"><link rel="prefetch" href="/Notebook/assets/js/289.f98fd683.js"><link rel="prefetch" href="/Notebook/assets/js/29.d2e43523.js"><link rel="prefetch" href="/Notebook/assets/js/290.a16d65aa.js"><link rel="prefetch" href="/Notebook/assets/js/291.fc9bd002.js"><link rel="prefetch" href="/Notebook/assets/js/292.118fe91a.js"><link rel="prefetch" href="/Notebook/assets/js/293.6f1d9c68.js"><link rel="prefetch" href="/Notebook/assets/js/294.0bcb5275.js"><link rel="prefetch" href="/Notebook/assets/js/295.7b0fad94.js"><link rel="prefetch" href="/Notebook/assets/js/296.9f9712a5.js"><link rel="prefetch" href="/Notebook/assets/js/297.7febdd59.js"><link rel="prefetch" href="/Notebook/assets/js/298.3675462a.js"><link rel="prefetch" href="/Notebook/assets/js/299.10b010f0.js"><link rel="prefetch" href="/Notebook/assets/js/3.d4ed84ce.js"><link rel="prefetch" href="/Notebook/assets/js/30.7c1f3583.js"><link rel="prefetch" href="/Notebook/assets/js/300.115bd53b.js"><link rel="prefetch" href="/Notebook/assets/js/301.fabbbf0b.js"><link rel="prefetch" href="/Notebook/assets/js/302.57b83223.js"><link rel="prefetch" href="/Notebook/assets/js/303.4e639a46.js"><link rel="prefetch" href="/Notebook/assets/js/304.a35644ff.js"><link rel="prefetch" href="/Notebook/assets/js/305.20d8bbbe.js"><link rel="prefetch" href="/Notebook/assets/js/306.7253f469.js"><link rel="prefetch" href="/Notebook/assets/js/307.75c667f4.js"><link rel="prefetch" href="/Notebook/assets/js/308.f263e4b6.js"><link rel="prefetch" href="/Notebook/assets/js/309.db89dce5.js"><link rel="prefetch" href="/Notebook/assets/js/31.46a6d02f.js"><link rel="prefetch" href="/Notebook/assets/js/310.daa82fee.js"><link rel="prefetch" href="/Notebook/assets/js/311.8412981b.js"><link rel="prefetch" href="/Notebook/assets/js/312.525a26b3.js"><link rel="prefetch" href="/Notebook/assets/js/313.2ebb5383.js"><link rel="prefetch" href="/Notebook/assets/js/32.e657ae7e.js"><link rel="prefetch" href="/Notebook/assets/js/33.8425ca14.js"><link rel="prefetch" href="/Notebook/assets/js/34.e266fc3a.js"><link rel="prefetch" href="/Notebook/assets/js/35.189d30e1.js"><link rel="prefetch" href="/Notebook/assets/js/36.e60ffce6.js"><link rel="prefetch" href="/Notebook/assets/js/37.abdfdc7c.js"><link rel="prefetch" href="/Notebook/assets/js/38.b04368b3.js"><link rel="prefetch" href="/Notebook/assets/js/39.d2adf2bf.js"><link rel="prefetch" href="/Notebook/assets/js/40.35f710b4.js"><link rel="prefetch" href="/Notebook/assets/js/41.8815f14f.js"><link rel="prefetch" href="/Notebook/assets/js/42.f427aa0a.js"><link rel="prefetch" href="/Notebook/assets/js/43.ac86c129.js"><link rel="prefetch" href="/Notebook/assets/js/44.7dec7c54.js"><link rel="prefetch" href="/Notebook/assets/js/45.5fb385e5.js"><link rel="prefetch" href="/Notebook/assets/js/46.33c8a4cd.js"><link rel="prefetch" href="/Notebook/assets/js/47.dd20eb6f.js"><link rel="prefetch" href="/Notebook/assets/js/48.584b92ce.js"><link rel="prefetch" href="/Notebook/assets/js/49.041711a1.js"><link rel="prefetch" href="/Notebook/assets/js/5.b5d0cdd7.js"><link rel="prefetch" href="/Notebook/assets/js/50.8abc2f33.js"><link rel="prefetch" href="/Notebook/assets/js/51.89c79440.js"><link rel="prefetch" href="/Notebook/assets/js/52.34920dcb.js"><link rel="prefetch" href="/Notebook/assets/js/53.fc9689ee.js"><link rel="prefetch" href="/Notebook/assets/js/54.3e6daef2.js"><link rel="prefetch" href="/Notebook/assets/js/55.04dc507e.js"><link rel="prefetch" href="/Notebook/assets/js/56.38a79a77.js"><link rel="prefetch" href="/Notebook/assets/js/57.1a819b05.js"><link rel="prefetch" href="/Notebook/assets/js/58.24921926.js"><link rel="prefetch" href="/Notebook/assets/js/59.cb6c3a52.js"><link rel="prefetch" href="/Notebook/assets/js/6.4ad1c19d.js"><link rel="prefetch" href="/Notebook/assets/js/60.bd7eaa9a.js"><link rel="prefetch" href="/Notebook/assets/js/61.fb5959a5.js"><link rel="prefetch" href="/Notebook/assets/js/62.4ca2a61c.js"><link rel="prefetch" href="/Notebook/assets/js/63.db776fb0.js"><link rel="prefetch" href="/Notebook/assets/js/64.5862c070.js"><link rel="prefetch" href="/Notebook/assets/js/65.a562da8c.js"><link rel="prefetch" href="/Notebook/assets/js/66.9428e6a9.js"><link rel="prefetch" href="/Notebook/assets/js/67.380c3893.js"><link rel="prefetch" href="/Notebook/assets/js/68.4a1d975a.js"><link rel="prefetch" href="/Notebook/assets/js/69.f72c1c2a.js"><link rel="prefetch" href="/Notebook/assets/js/7.f18c22e1.js"><link rel="prefetch" href="/Notebook/assets/js/70.081e9efc.js"><link rel="prefetch" href="/Notebook/assets/js/71.9628b6c9.js"><link rel="prefetch" href="/Notebook/assets/js/72.fd7c0d8b.js"><link rel="prefetch" href="/Notebook/assets/js/73.ade29c87.js"><link rel="prefetch" href="/Notebook/assets/js/74.9beb3002.js"><link rel="prefetch" href="/Notebook/assets/js/75.4a0d7566.js"><link rel="prefetch" href="/Notebook/assets/js/76.82cba373.js"><link rel="prefetch" href="/Notebook/assets/js/77.cbc62dec.js"><link rel="prefetch" href="/Notebook/assets/js/78.7f360c8b.js"><link rel="prefetch" href="/Notebook/assets/js/79.fa101a6c.js"><link rel="prefetch" href="/Notebook/assets/js/8.b60843f8.js"><link rel="prefetch" href="/Notebook/assets/js/80.eff15427.js"><link rel="prefetch" href="/Notebook/assets/js/81.6cb7b0db.js"><link rel="prefetch" href="/Notebook/assets/js/82.8301875b.js"><link rel="prefetch" href="/Notebook/assets/js/83.36e9eaed.js"><link rel="prefetch" href="/Notebook/assets/js/84.6dab4e8d.js"><link rel="prefetch" href="/Notebook/assets/js/85.2698a308.js"><link rel="prefetch" href="/Notebook/assets/js/86.ef360da8.js"><link rel="prefetch" href="/Notebook/assets/js/87.768ec866.js"><link rel="prefetch" href="/Notebook/assets/js/88.ab9a859f.js"><link rel="prefetch" href="/Notebook/assets/js/89.d7a10705.js"><link rel="prefetch" href="/Notebook/assets/js/9.e93336f2.js"><link rel="prefetch" href="/Notebook/assets/js/90.ffb88a3d.js"><link rel="prefetch" href="/Notebook/assets/js/91.196c3e62.js"><link rel="prefetch" href="/Notebook/assets/js/92.c6c9f350.js"><link rel="prefetch" href="/Notebook/assets/js/93.4a2bfcd4.js"><link rel="prefetch" href="/Notebook/assets/js/94.5e133456.js"><link rel="prefetch" href="/Notebook/assets/js/95.90e64ed0.js"><link rel="prefetch" href="/Notebook/assets/js/96.e7faab2f.js"><link rel="prefetch" href="/Notebook/assets/js/97.5369d09a.js"><link rel="prefetch" href="/Notebook/assets/js/98.b3ce3ca9.js"><link rel="prefetch" href="/Notebook/assets/js/99.00453fa5.js">
    <link rel="stylesheet" href="/Notebook/assets/css/0.styles.8f4327af.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/Notebook/" class="home-link router-link-active"><!----> <span class="site-name">Naluduo's Notebook</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/Notebook/dailyRecord/" class="nav-link">
  📝日常记录
</a></div><div class="nav-item"><a href="/Notebook/blogs/" class="nav-link">
  📖文章合集
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="开发者" class="dropdown-title"><span class="title">开发者</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Notebook/frontend-web/" class="nav-link">
  💻大前端
</a></li><li class="dropdown-item"><!----> <a href="/Notebook/web-framework/" class="nav-link">
  🐂web 框架
</a></li><li class="dropdown-item"><!----> <a href="/Notebook/rethink/" class="nav-link">
  🤔复盘
</a></li><li class="dropdown-item"><h4>
          ️️🧘算法修炼
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Notebook/understand-the-computer/" class="nav-link">
  理解计算机
</a></li><li class="dropdown-subitem"><a href="/Notebook/algorithm/dataStructure.html" class="nav-link">
  数据结构
</a></li><li class="dropdown-subitem"><a href="/Notebook/algorithm/algorithm.html" class="nav-link">
  算法分类
</a></li><li class="dropdown-subitem"><a href="/Notebook/dataBase/index.html" class="nav-link">
  数据库
</a></li></ul></li><li class="dropdown-item"><!----> <a href="/Notebook/devops/" class="nav-link">
  ☁️运维
</a></li><li class="dropdown-item"><!----> <a href="/Notebook/test/" class="nav-link">
  🚬测试
</a></li><li class="dropdown-item"><!----> <a href="/Notebook/gis/" class="nav-link">
  🌍GIS
</a></li><li class="dropdown-item"><!----> <a href="/Notebook/tools/" class="nav-link">
  ️️🖱️工具
</a></li><li class="dropdown-item"><!----> <a href="/Notebook/network/" class="nav-link">
  ️️🐛网络工程
</a></li><li class="dropdown-item"><!----> <a href="/Notebook/game-development/" class="nav-link">
  ️️🎮游戏开发
</a></li><li class="dropdown-item"><!----> <a href="/Notebook/programming-language/" class="nav-link">
  🚶编程语言
</a></li><li class="dropdown-item"><!----> <a href="/Notebook/programming-paradigm/" class="nav-link">
  编程范式
</a></li></ul></div></div><div class="nav-item"><a href="/Notebook/lint/" class="nav-link">
  ✔️编码规范&amp;协同开发
</a></div><div class="nav-item"><a href="/Notebook/math/" class="nav-link">
  𝜋数学
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="设计" class="dropdown-title"><span class="title">设计</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Notebook/design/" class="nav-link">
  🖌️UI
</a></li></ul></div></div><div class="nav-item"><a href="/Notebook/bookmark/" class="nav-link">
  🏷书签整理
</a></div><div class="nav-item"><a href="http://shooterblog.site/Learn-JS-Demo/%E5%89%8D%E7%AB%AF%E7%9F%A5%E8%AF%86%E5%9B%BE%E8%B0%B1/index.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  📖知识脑图
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="http://www.jecyu.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  🔧个人博客
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="🔗Github" class="dropdown-title"><span class="title">🔗Github</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/Jecyu" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Jecyu github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://naluduo233.github.io/language-learning/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  英语学习
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://naluduo233.github.io/Fe-Auto-Testing/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  前端自动化测试
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://naluduo233.github.io/JS-Event-Loop/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  JS 事件循环机制
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://naluduo233.github.io/Web-Performance-Optimization/reference/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  微谈 Web 前端性能优化
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/Notebook/dailyRecord/" class="nav-link">
  📝日常记录
</a></div><div class="nav-item"><a href="/Notebook/blogs/" class="nav-link">
  📖文章合集
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="开发者" class="dropdown-title"><span class="title">开发者</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Notebook/frontend-web/" class="nav-link">
  💻大前端
</a></li><li class="dropdown-item"><!----> <a href="/Notebook/web-framework/" class="nav-link">
  🐂web 框架
</a></li><li class="dropdown-item"><!----> <a href="/Notebook/rethink/" class="nav-link">
  🤔复盘
</a></li><li class="dropdown-item"><h4>
          ️️🧘算法修炼
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Notebook/understand-the-computer/" class="nav-link">
  理解计算机
</a></li><li class="dropdown-subitem"><a href="/Notebook/algorithm/dataStructure.html" class="nav-link">
  数据结构
</a></li><li class="dropdown-subitem"><a href="/Notebook/algorithm/algorithm.html" class="nav-link">
  算法分类
</a></li><li class="dropdown-subitem"><a href="/Notebook/dataBase/index.html" class="nav-link">
  数据库
</a></li></ul></li><li class="dropdown-item"><!----> <a href="/Notebook/devops/" class="nav-link">
  ☁️运维
</a></li><li class="dropdown-item"><!----> <a href="/Notebook/test/" class="nav-link">
  🚬测试
</a></li><li class="dropdown-item"><!----> <a href="/Notebook/gis/" class="nav-link">
  🌍GIS
</a></li><li class="dropdown-item"><!----> <a href="/Notebook/tools/" class="nav-link">
  ️️🖱️工具
</a></li><li class="dropdown-item"><!----> <a href="/Notebook/network/" class="nav-link">
  ️️🐛网络工程
</a></li><li class="dropdown-item"><!----> <a href="/Notebook/game-development/" class="nav-link">
  ️️🎮游戏开发
</a></li><li class="dropdown-item"><!----> <a href="/Notebook/programming-language/" class="nav-link">
  🚶编程语言
</a></li><li class="dropdown-item"><!----> <a href="/Notebook/programming-paradigm/" class="nav-link">
  编程范式
</a></li></ul></div></div><div class="nav-item"><a href="/Notebook/lint/" class="nav-link">
  ✔️编码规范&amp;协同开发
</a></div><div class="nav-item"><a href="/Notebook/math/" class="nav-link">
  𝜋数学
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="设计" class="dropdown-title"><span class="title">设计</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Notebook/design/" class="nav-link">
  🖌️UI
</a></li></ul></div></div><div class="nav-item"><a href="/Notebook/bookmark/" class="nav-link">
  🏷书签整理
</a></div><div class="nav-item"><a href="http://shooterblog.site/Learn-JS-Demo/%E5%89%8D%E7%AB%AF%E7%9F%A5%E8%AF%86%E5%9B%BE%E8%B0%B1/index.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  📖知识脑图
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="http://www.jecyu.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  🔧个人博客
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="🔗Github" class="dropdown-title"><span class="title">🔗Github</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/Jecyu" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Jecyu github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://naluduo233.github.io/language-learning/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  英语学习
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://naluduo233.github.io/Fe-Auto-Testing/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  前端自动化测试
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://naluduo233.github.io/JS-Event-Loop/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  JS 事件循环机制
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://naluduo233.github.io/Web-Performance-Optimization/reference/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  微谈 Web 前端性能优化
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>算法</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Notebook/algorithm/design-principles.html" class="sidebar-link">设计原则和编程技巧</a></li><li><a href="/Notebook/algorithm/dataStructure.html" class="sidebar-link">/algorithm/dataStructure.html</a></li><li><a href="/Notebook/algorithm/algorithm.html" class="sidebar-link">算法分类</a></li><li><a href="/Notebook/algorithm/patterns.html" aria-current="page" class="active sidebar-link">设计模式</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Notebook/algorithm/patterns.html#前言" class="sidebar-link">前言</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Notebook/algorithm/patterns.html#solid-设计原则" class="sidebar-link">SOLID 设计原则</a></li><li class="sidebar-sub-header"><a href="/Notebook/algorithm/patterns.html#设计模式的核心思想-封装变化" class="sidebar-link">设计模式的核心思想-封装变化</a></li><li class="sidebar-sub-header"><a href="/Notebook/algorithm/patterns.html#设计模式的-术" class="sidebar-link">设计模式的“术”</a></li></ul></li><li class="sidebar-sub-header"><a href="/Notebook/algorithm/patterns.html#创建型" class="sidebar-link">创建型</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Notebook/algorithm/patterns.html#工厂模式-简单工厂" class="sidebar-link">工厂模式-简单工厂</a></li><li class="sidebar-sub-header"><a href="/Notebook/algorithm/patterns.html#原型模式-谈-prototype-无小事" class="sidebar-link">原型模式—谈 prototype 无小事</a></li></ul></li><li class="sidebar-sub-header"><a href="/Notebook/algorithm/patterns.html#结构型" class="sidebar-link">结构型</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Notebook/algorithm/patterns.html#代理设计模式" class="sidebar-link">代理设计模式</a></li><li class="sidebar-sub-header"><a href="/Notebook/algorithm/patterns.html#装饰者模式-对象装上它，就像开了挂" class="sidebar-link">装饰者模式——对象装上它，就像开了挂</a></li><li class="sidebar-sub-header"><a href="/Notebook/algorithm/patterns.html#基本示例" class="sidebar-link">基本示例</a></li><li class="sidebar-sub-header"><a href="/Notebook/algorithm/patterns.html#装饰器语法糖背后的故事" class="sidebar-link">装饰器语法糖背后的故事</a></li><li class="sidebar-sub-header"><a href="/Notebook/algorithm/patterns.html#真实应用（实际例子）" class="sidebar-link">真实应用（实际例子）</a></li><li class="sidebar-sub-header"><a href="/Notebook/algorithm/patterns.html#介绍" class="sidebar-link">介绍</a></li><li class="sidebar-sub-header"><a href="/Notebook/algorithm/patterns.html#实现" class="sidebar-link">实现</a></li></ul></li><li class="sidebar-sub-header"><a href="/Notebook/algorithm/patterns.html#行为型" class="sidebar-link">行为型</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Notebook/algorithm/patterns.html#备忘录模式" class="sidebar-link">备忘录模式</a></li><li class="sidebar-sub-header"><a href="/Notebook/algorithm/patterns.html#观察者模式" class="sidebar-link">观察者模式</a></li><li class="sidebar-sub-header"><a href="/Notebook/algorithm/patterns.html#实现-2" class="sidebar-link">实现</a></li></ul></li><li class="sidebar-sub-header"><a href="/Notebook/algorithm/patterns.html#单例模式" class="sidebar-link">单例模式</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Notebook/algorithm/patterns.html#原因" class="sidebar-link">原因</a></li><li class="sidebar-sub-header"><a href="/Notebook/algorithm/patterns.html#实现-3" class="sidebar-link">实现</a></li><li class="sidebar-sub-header"><a href="/Notebook/algorithm/patterns.html#应用场景" class="sidebar-link">应用场景</a></li></ul></li><li class="sidebar-sub-header"><a href="/Notebook/algorithm/patterns.html#命令模式" class="sidebar-link">命令模式</a></li><li class="sidebar-sub-header"><a href="/Notebook/algorithm/patterns.html#适配器模式" class="sidebar-link">适配器模式</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Notebook/algorithm/patterns.html#现实中的适配器" class="sidebar-link">现实中的适配器</a></li><li class="sidebar-sub-header"><a href="/Notebook/algorithm/patterns.html#适配器模式的应用" class="sidebar-link">适配器模式的应用</a></li><li class="sidebar-sub-header"><a href="/Notebook/algorithm/patterns.html#小结" class="sidebar-link">小结</a></li><li class="sidebar-sub-header"><a href="/Notebook/algorithm/patterns.html#策略模式" class="sidebar-link">策略模式</a></li><li class="sidebar-sub-header"><a href="/Notebook/algorithm/patterns.html#行为型：状态模式" class="sidebar-link">行为型：状态模式</a></li><li class="sidebar-sub-header"><a href="/Notebook/algorithm/patterns.html#基本示例-自助咖啡机背后的力量" class="sidebar-link">基本示例——自助咖啡机背后的力量</a></li><li class="sidebar-sub-header"><a href="/Notebook/algorithm/patterns.html#真实场景" class="sidebar-link">真实场景</a></li><li class="sidebar-sub-header"><a href="/Notebook/algorithm/patterns.html#与策略模式辨析" class="sidebar-link">与策略模式辨析</a></li><li class="sidebar-sub-header"><a href="/Notebook/algorithm/patterns.html#状态模式复盘" class="sidebar-link">状态模式复盘</a></li></ul></li><li class="sidebar-sub-header"><a href="/Notebook/algorithm/patterns.html#行为型：观察者模式" class="sidebar-link">行为型：观察者模式</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Notebook/algorithm/patterns.html#真实示例" class="sidebar-link">真实示例</a></li><li class="sidebar-sub-header"><a href="/Notebook/algorithm/patterns.html#观察者模式与发布-订阅模式的区别是什么" class="sidebar-link">观察者模式与发布-订阅模式的区别是什么</a></li></ul></li><li class="sidebar-sub-header"><a href="/Notebook/algorithm/patterns.html#参考资料" class="sidebar-link">参考资料</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="设计模式"><a href="#设计模式" class="header-anchor">#</a> 设计模式</h1> <h2 id="前言"><a href="#前言" class="header-anchor">#</a> 前言</h2> <p><strong>识别题目特征——catch 题目想要考察的知识点——快速在脑海中映射出它对应的解决方法</strong>，这个过程在我们学生时代几乎是一个本能的、条件反射一样的脑回路机制。在学习设计模式时，也可以回忆起这种“从映射到默写”的思维方式。</p> <p>先广度后深度。</p> <h3 id="solid-设计原则"><a href="#solid-设计原则" class="header-anchor">#</a> SOLID 设计原则</h3> <ul><li>单一功能原则</li> <li>开放封闭原则</li> <li>里氏替换原则</li> <li>接口隔离原则</li> <li>依赖反转原则</li></ul> <h3 id="设计模式的核心思想-封装变化"><a href="#设计模式的核心思想-封装变化" class="header-anchor">#</a> 设计模式的核心思想-封装变化</h3> <p>考虑业务需求的多变，导致代码的更新频繁。</p> <p>将变与不变分离，确保变化的部分灵活、不变的部分稳定。</p> <h3 id="设计模式的-术"><a href="#设计模式的-术" class="header-anchor">#</a> 设计模式的“术”</h3> <p><img src="/Notebook/assets/img/2020-11-03-13-32-25.61d07263.png" alt=""></p> <p>设计模式的核心思想，就是“封装变化”。确实如此，无论是创建型、结构型还是行为型，这些具体的设计模型都是在用自己的方式去封装不同类型的变化——<strong>创建型模式封装了创建对象过程中的变化</strong>，比如工厂模式，它做的事情就是将创建对象的过程抽离；<strong>结构型模式封装的是对象之间组合方式的变化，目的在于灵活地表达对象间的配合与依赖关系</strong>；<strong>而行为型模式则是将是对象千变万化的行为进行抽离</strong>，确保我们能够更安全、更方便地对行为进行更改。</p> <h2 id="创建型"><a href="#创建型" class="header-anchor">#</a> 创建型</h2> <h3 id="工厂模式-简单工厂"><a href="#工厂模式-简单工厂" class="header-anchor">#</a> 工厂模式-简单工厂</h3> <h3 id="原型模式-谈-prototype-无小事"><a href="#原型模式-谈-prototype-无小事" class="header-anchor">#</a> 原型模式—谈 prototype 无小事</h3> <p>在原型模式下，当我们想要创建一个对象时，会先找到一个对象作为原型，然后通过<strong>克隆原型</strong>的方式来创建一个与原型一样（共享一套数据/方法）的对象。</p> <p>原型编程范式的核心思想就是<strong>利用实例来描述对象，用实例定义对象和继承的基础。<strong>在 JavaScript 中，原型编程范式的体现就是</strong>基于原型链的继承。</strong></p> <h2 id="结构型"><a href="#结构型" class="header-anchor">#</a> 结构型</h2> <h3 id="代理设计模式"><a href="#代理设计模式" class="header-anchor">#</a> 代理设计模式</h3> <p><img src="/Notebook/assets/img/2021-04-03-08-31-37.934a596e.png" alt=""></p> <p>真实例子：</p> <ul><li>vue 代理</li> <li>xxx 文章，第一次输出 obj.a = 1，第二次 obj.a = 2</li> <li>分层分级代理和跨域代理</li></ul> <h3 id="装饰者模式-对象装上它，就像开了挂"><a href="#装饰者模式-对象装上它，就像开了挂" class="header-anchor">#</a> 装饰者模式——对象装上它，就像开了挂</h3> <h3 id="基本示例"><a href="#基本示例" class="header-anchor">#</a> 基本示例</h3> <ul><li>用一两句话来说明问题。</li> <li>用一两句话解释最简单的可能的解决方案。</li> <li>显示一小段代码示例。</li> <li>用一句话解释它完成了什么。</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 点击打开按钮展示模态框</span>
document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;open&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;click&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 按钮对象/组件</span>
  <span class="token function">openModal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 装饰器 1</span>
  <span class="token function">changeButtonStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 装饰器 2</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token regex">/_ 抽离旧逻辑 _/</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">openModal</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 未点击则不创建 modal 实例，避免不必要的内存占用</span>
  <span class="token keyword">const</span> modal <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Modal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  modal<span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token string">&quot;block&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/* 编写新逻辑 */</span>
<span class="token comment">// 按钮文案修改逻辑</span>
<span class="token keyword">function</span> <span class="token function">changeButtonText</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> btn <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;open&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  btn<span class="token punctuation">.</span>innerText <span class="token operator">=</span> <span class="token string">&quot;快去登录&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 按钮置灰逻辑</span>
<span class="token keyword">function</span> <span class="token function">disableButton</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> btn <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;open&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  btn<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;disabled&quot;</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 新版本功能逻辑整合</span>
<span class="token keyword">function</span> <span class="token function">changeButtonStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">changeButtonText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">disableButton</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><p>关于其价值的细节</p> <ul><li>解决人们在看例子时可能遇到的常见问题。(最好以块引用格式呈现)</li> <li>显示常见错误的例子，以及如何避免它们。</li> <li>用非常简单的代码示例展示好模式和坏模式。</li> <li>讨论这个模式令人信服的理由。参考链接不是必需的，但鼓励提供。</li></ul> <h3 id="装饰器语法糖背后的故事"><a href="#装饰器语法糖背后的故事" class="header-anchor">#</a> 装饰器语法糖背后的故事</h3> <h4 id="函数传参-调用"><a href="#函数传参-调用" class="header-anchor">#</a> 函数传参&amp;调用</h4> <ul><li>类装饰器的参数</li> <li>方法装饰器的参数</li> <li>装饰器函数调用的时机</li></ul> <p>定义装饰器函数，将被装饰者“交给”装饰器。</p> <h4 id="将-属性描述对象-交到你手里"><a href="#将-属性描述对象-交到你手里" class="header-anchor">#</a> 将“属性描述对象”交到你手里</h4> <h3 id="真实应用（实际例子）"><a href="#真实应用（实际例子）" class="header-anchor">#</a> 真实应用（实际例子）</h3> <p>高阶函数和高阶组件其实就是装饰者模式的应用。</p> <h4 id="react-中的装饰器：hoc"><a href="#react-中的装饰器：hoc" class="header-anchor">#</a> React 中的装饰器：HOC</h4> <blockquote><p>高阶组件就是一个函数，且该函数接受一个组件作为参数，并返回一个新的组件。</p></blockquote> <p>很多大的函数，比如图层加载这个函数，可以借鉴上面的小例子，分析旧逻辑与新功能。然后把旧的逻辑抽离出来，再组合新功能，这样就不会影响旧的功能。</p> <h4 id="vue-中的装饰器"><a href="#vue-中的装饰器" class="header-anchor">#</a> Vue 中的装饰器</h4> <h3 id="介绍"><a href="#介绍" class="header-anchor">#</a> 介绍</h3> <p>我们玩魔兽争霸的任务关时，对 15 级乱加技能点的野生英雄普遍没有好感，<u>而是喜欢留着技能点，在游戏的进行过程中按需加技能。</u>同样，在程序开发中，<u><code>许多时候都并不希望某个类天生就非常庞大，一次性包含许多职责</code>。那么我们就可以使用装饰者模式。装饰者可以动态地给某个对象添加一些额外的职责，而不会影响从这个类中派生的其他对象。</u></p> <h4 id="主要解决"><a href="#主要解决" class="header-anchor">#</a> 主要解决</h4> <p>在传统的面向对象语言中，给对象添加功能常常使用继承的方式但是继承的方式并不灵活，还会带来许多问题：<u>一方面会导致超类和子类之间存在<code>强耦合性</code></u>，当超类改变时，子类也会随之改变；另一方面，继承这种功能复用方式通常被称为“白箱服用”，“白箱是相对可见性而言的”，<u>在继承方式中，超类的内部细节是对子类可见的，继承常常被认为破坏了封装性。</u></p> <p>使用继承还会带有另外一个问题，在完成一些功能复用的同时，<u>有可能创建出<code>大量的子类</code>，使子类的数量呈爆炸性增长。</u>比如现在有 4 种型号的自行车，我们为每种自行车都定义了一个单独的类。现在要给每种自行车都装上前灯、尾灯和铃铛这 3 种配件。如果使用继承的方式来给每种自行车创建子类，则需要 4*3 = 12 个子类。（因为许多时候都并不希望某个类天生就非常庞大，一次性包含许多职责）<u>但是，如果把前灯、尾灯、铃铛这些对象动态 组合到自行车上面，则只需要额外增加 3 个类。</u>装饰器的概念跟组合很像，例如一个对象可以由多个不同的组件组合而成。</p> <p><u>这种给对象动态地增加职责的方式称为装饰者（decorator）模式。</u><strong>装饰者模式能够在不改变对象自身的基础上，在程序运行期间给对象动态地添加职责。</strong>跟继承相比，装饰者是一种更轻便灵活的做法，<u>这是一种“即用即付”的方式</u>，比如天冷了就多穿一件外套，需要飞行时就在头上插一支竹蜻蜓，遇到一堆食尸鬼时就点开 AOE（范围攻击）技能。</p> <h4 id="如何解决"><a href="#如何解决" class="header-anchor">#</a> 如何解决</h4> <h5 id="uml-图"><a href="#uml-图" class="header-anchor">#</a> UML 图</h5> <h5 id="模拟传统面向对象语言的装饰者模式"><a href="#模拟传统面向对象语言的装饰者模式" class="header-anchor">#</a> 模拟传统面向对象语言的装饰者模式</h5> <p>第一种，给 JavaScript 中的对戏动态</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">&quot;sven&quot;</span><span class="token punctuation">,</span>
  address<span class="token operator">:</span> <span class="token string">&quot;深圳市&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
obj<span class="token punctuation">.</span>address <span class="token operator">=</span> obj<span class="token punctuation">.</span>address <span class="token operator">+</span> <span class="token string">&quot;福田区&quot;</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>假设我们在编写一个飞机大战的游戏</p> <p>第二种 模拟传统面向对象语言的装饰者模式</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">Plane</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token class-name">Plane</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">fire</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;发射普通子弹&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">MissileDecorator</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">plane</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>plane <span class="token operator">=</span> plane<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token class-name">MissileDecorator</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">fire</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>plane<span class="token punctuation">.</span><span class="token function">fire</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;发射导弹&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">AtomDecorator</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">plane</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 传入目标</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>plane <span class="token operator">=</span> plane<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token class-name">AtomDecorator</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">fire</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>plane<span class="token punctuation">.</span><span class="token function">fire</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;发射原子弹&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> plane <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Plane</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
plane <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MissileDecorator</span><span class="token punctuation">(</span>plane<span class="token punctuation">)</span><span class="token punctuation">;</span>
plane <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AtomDecorator</span><span class="token punctuation">(</span>plane<span class="token punctuation">)</span><span class="token punctuation">;</span>

plane<span class="token punctuation">.</span><span class="token function">fire</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 分别输出：发射普通子弹、发射导弹、发射原子弹</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><p>导弹类和原子弹类都接受参数 plane 对象，并且保存好这个参数，在它们的 fire 方法中，除了执行自身的操作外，还调用 plane 对象的 fire 方法。</p> <p><u>这种给对象动态添加职责的方式，并没有真正地改动对象自身，而是将对象放入到另一个对象之中，这些对象以一条链的方式进行引用，形成一个聚合对象。这些对象都拥有相同的接口（fire 方法），当请求到达链中的某个对象时，这个对象会执行自身的操作，随后把请求转发给链中的下一个对象。</u></p> <p>因为装饰者对象和它所装饰的对象拥有一致的接口，所以它们对使用该对象的客户来说是透明的，被装饰的对象也并不需要了解它曾经曾经被装饰过，这种透明性使得我们可以递归地嵌套任意多个装饰者对象。如图所示。</p> <p><img src="/Notebook/assets/img/decorator-1.8341dac2.png" alt=""></p> <h4 id="装饰器也是包装器"><a href="#装饰器也是包装器" class="header-anchor">#</a> 装饰器也是包装器</h4> <p>从功能上而言，decorator 能很好地描述这个模式，但从结构上看，wrapper 的说法更加贴切。**装饰器模式将一个对象嵌入另一个对象之中，实际上相当于这个对象被另一个对象包装起来，形成一条包装链。**请求随着这条链依次传递到所有的对象，每个对象都有处理这条请求的机会。</p> <p><img src="/Notebook/assets/img/decorator-2.66da197b.png" alt=""></p> <h4 id="关键代码"><a href="#关键代码" class="header-anchor">#</a> 关键代码</h4> <h4 id="优点"><a href="#优点" class="header-anchor">#</a> 优点</h4> <h4 id="缺点"><a href="#缺点" class="header-anchor">#</a> 缺点</h4> <h4 id="使用场景"><a href="#使用场景" class="header-anchor">#</a> 使用场景</h4> <ul><li><a href="https://juejin.im/post/6856517315010232333#heading-8" target="_blank" rel="noopener noreferrer">在 Vue 中使用装饰器，我是认真的<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <h5 id="ts-中，vue-decorator-的实现"><a href="#ts-中，vue-decorator-的实现" class="header-anchor">#</a> ts 中，vue-decorator 的实现</h5> <h4 id="js-装饰器"><a href="#js-装饰器" class="header-anchor">#</a> JS 装饰器</h4> <h3 id="实现"><a href="#实现" class="header-anchor">#</a> 实现</h3> <h2 id="行为型"><a href="#行为型" class="header-anchor">#</a> 行为型</h2> <h3 id="备忘录模式"><a href="#备忘录模式" class="header-anchor">#</a> 备忘录模式</h3> <p>备忘录模式又称为快照模式（Snapshot Pattern）或 Token 模式。</p> <p>故名游戏存档、数据库事务、crtl + z。</p> <p>使用场景</p> <ul><li>需要保存历史快照的场景</li> <li>希望在对象之外保存状态，且除了自己其他类对象无法访问状态保存具体内容。</li></ul> <h4 id="具体实现"><a href="#具体实现" class="header-anchor">#</a> 具体实现</h4> <p>主要目的是保存一个对象的某个状态，以便在适当的时候恢复对象。假设有原始类 A，A 中有各种属性，A 可以决定需要备份的属性，备忘录类 B 是用来存储 A 的一些内部状态，类 C 用来存储备忘录的，只能存储，不能修改。</p> <p><img src="/Notebook/assets/img/2020-12-15-15-30-54.4708df20.png" alt=""></p> <p>Origin 是原始类，里面有需要保存的属性 value 以及创建一个备忘录的类方法，用来保存 value 值。</p> <p>Memento 类是备忘录类，Storeage 类是存储备忘录的类，持有 Memento 类的实类。</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">class</span> <span class="token class-name">Memento</span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> _value<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  <span class="token keyword">constructor</span><span class="token punctuation">(</span><span class="token parameter">value<span class="token operator">:</span> <span class="token builtin">string</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>_value <span class="token operator">=</span> value<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">public</span> <span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_value<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">public</span> <span class="token function">setValue</span><span class="token punctuation">(</span><span class="token parameter">value<span class="token operator">:</span> <span class="token builtin">string</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>_value <span class="token operator">=</span> value<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> Memento<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">class</span> <span class="token class-name">Original</span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> _value<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  <span class="token keyword">constructor</span><span class="token punctuation">(</span><span class="token parameter">value<span class="token operator">:</span> <span class="token builtin">string</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>_value <span class="token operator">=</span> value<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">public</span> <span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_value<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">public</span> <span class="token function">setValue</span><span class="token punctuation">(</span><span class="token parameter">value<span class="token operator">:</span> <span class="token builtin">string</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>_value <span class="token operator">=</span> value<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">/**
   * @description: 创建备忘录
   * @param {*}
   * @return {*}
   */</span>
  <span class="token keyword">public</span> <span class="token function">createMemento</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> Memento <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Memento</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>_value<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token function">restoreMemento</span><span class="token punctuation">(</span><span class="token parameter">memento<span class="token operator">:</span> Memento</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>_value <span class="token operator">=</span> memento<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">class</span> <span class="token class-name">Storage</span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> _memento<span class="token operator">:</span> Memento<span class="token punctuation">;</span>
  <span class="token keyword">constructor</span><span class="token punctuation">(</span><span class="token parameter">memento<span class="token operator">:</span> Memento</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>_memento <span class="token operator">=</span> memento<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">public</span> <span class="token function">getMemento</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> Memento <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_memento<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">public</span> <span class="token function">setMemento</span><span class="token punctuation">(</span><span class="token parameter">value<span class="token operator">:</span> Memento</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>_memento <span class="token operator">=</span> value<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> Storage<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">&quot;Name of the group&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">&quot;should restore state correctly&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// 创建原始类</span>
    <span class="token keyword">const</span> origin<span class="token operator">:</span> Original <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Original</span><span class="token punctuation">(</span><span class="token string">&quot;egg&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 创建备忘录</span>
    <span class="token keyword">const</span> storage<span class="token operator">:</span> Storage <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Storage</span><span class="token punctuation">(</span>origin<span class="token punctuation">.</span><span class="token function">createMemento</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 修改原始类的状态</span>
    <span class="token function">expect</span><span class="token punctuation">(</span>origin<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token string">&quot;egg&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 初始化状态 `egg`</span>
    origin<span class="token punctuation">.</span><span class="token function">setValue</span><span class="token punctuation">(</span><span class="token string">&quot;niu&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">expect</span><span class="token punctuation">(</span>origin<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token string">&quot;niu&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 修改状态为 `niu`</span>

    <span class="token comment">// 恢复原始类的状态</span>
    origin<span class="token punctuation">.</span><span class="token function">restoreMemento</span><span class="token punctuation">(</span>storage<span class="token punctuation">.</span><span class="token function">getMemento</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">expect</span><span class="token punctuation">(</span>origin<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token string">&quot;egg&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p><img src="/Notebook/assets/img/2020-12-15-16-45-50.ca3dd0e1.png" alt=""></p> <p>在前端层面，如果是一次性的保存与操作，比如地图中的场景保存功能。</p> <p>需要把保存快照和恢复快照的方法放到 Map 对象中，而 aMemento 备忘录则是后端提供接口处理。其他的组件则是 aCaretaker 的职位。</p> <ul><li><a href="https://zhuanlan.zhihu.com/p/126247747" target="_blank" rel="noopener noreferrer">java23 种设计模式-行为型模式之备忘录模式<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://www.cnblogs.com/kubixuesheng/p/10353325.html#_label0" target="_blank" rel="noopener noreferrer">保存快照和撤销功能的实现方案——备忘录模式总结<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <h3 id="观察者模式"><a href="#观察者模式" class="header-anchor">#</a> 观察者模式</h3> <p>当对象存在一对多关系时，则使用观察者模式（Observer Pattern）。比如，当一个对象被修改时，则会自动通知它的依赖对象。观察者模式又叫做发布-订阅（Publish/Subscribe）模式、模式-视图（Model/View）模式、源-监听器（Source/Listener）模式或从属者（Dependents）。观察者模式属于一种对象行为型模式。</p> <h4 id="介绍-2"><a href="#介绍-2" class="header-anchor">#</a> 介绍</h4> <p><strong>意图</strong>：定义对象间的一种一对多的依赖关系，当一个对象的状态发生改变时，所有依赖于它的对象都得到通知并被自动更新。在此，发生改变的对象称为<strong>观察目标</strong>，而被通知的对象称为<strong>观察者</strong>，一个观察目标可以对应多个观察者，而且这些观察者之间没有相互联系，可以根据需要增加和删除观察者，使得系统更易于扩展，这就是观察者模式的模式动机。</p> <p><strong>主要解决</strong>：一个对象状态改变给其他对象通知的问题，而且要考虑到易用和低耦合（观察者之间没有联系），保证高度的协作。</p> <p><strong>如何解决</strong>：使用面向对象技术，可以将这种依赖弱化。</p> <p><strong>关键代码</strong>：在抽象类里有一个 ArrayList 存放观察者们。</p> <p><strong>优点</strong>：</p> <ul><li>观察者和被观察者是抽象耦合的。</li> <li>建立一套触发机制。</li></ul> <p><strong>缺点</strong>：</p> <ul><li>如果一个被观察者有很多的直接和间接的观察者的话，将所有的观察者都通知到会花费很多时间。（前端的话，如阻塞卡顿）</li> <li>如果在观察者和观察模板之间有循环依赖的话，观察目标会触发它们之间进行循环调用，可能导致系统崩溃。</li> <li>观察者模式没有相应的机制让观察者知道所观察的目标对象是怎么发生变化的，而仅仅只是知道观察目标发生了变化。</li></ul> <p><strong>使用场景</strong>：</p> <ul><li>一个抽象模型有两个方面，其中一个方面依赖于另一个方面。将这些方面封装在独立的对象中使它们可以各自独立地改变和复用。</li> <li>一个对象的改变将导致其他一个或多个对象也发生改变，而不知道具体有多少对象将发生改变，可以降低对象之间的耦合度。</li> <li>一个对象必须通知其他对象，而并不知道这些对象是谁。</li> <li>需要在系统中创建一个触发链，A 对象的行为将影响 B 对象，B 对象的行为将影响 C 对象......，可以使用观察者模式创建一种链式触发机制。</li></ul> <h3 id="实现-2"><a href="#实现-2" class="header-anchor">#</a> 实现</h3> <ul><li>一种一对多的依赖，当一个对象的状态发生改变时，所以依赖它的对象都将得到通知</li> <li>关于“观察者模式”的设计模式，也是 vue 响应式实现的核心，订阅发布模式是观察者模式的升级版，dojo 的 Topic，vue 的 eventBus 这些就是用的发布订阅模式</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Observer</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>subs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> cb</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    target<span class="token punctuation">.</span>subs<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>cb<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">publish</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>subs<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">sub</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">sub</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> ob1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Observer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> ob2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Observer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> ob3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Observer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

ob2<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>ob1<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;ob2 添加了对 ob1 的依赖，ob1 通知了我会响应&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

ob3<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>ob1<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;ob3 添加了对 ob1 的依赖，ob1 通知了我会响应&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

ob1<span class="token punctuation">.</span><span class="token function">publish</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ob1 发起了通知</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><h4 id="发布-订阅"><a href="#发布-订阅" class="header-anchor">#</a> 发布——订阅</h4> <ul><li>发布——订阅是观察者的升级版</li> <li>发布——订阅 拥有一个调度中心</li> <li>如果用 发布——订阅，上面 Observer 类的 subscribe 和 publish 方法都在 observer 对象（调度中心）进行管理</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> observer <span class="token operator">=</span> <span class="token punctuation">{</span>
  subs<span class="token operator">:</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token parameter">type<span class="token punctuation">,</span> cb</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>subs<span class="token punctuation">[</span>type<span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>subs<span class="token punctuation">[</span>type<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>cb<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">publish</span><span class="token punctuation">(</span><span class="token parameter">type<span class="token punctuation">,</span> <span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>subs<span class="token punctuation">[</span>type<span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">cb</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">cb</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

observer<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token string">&quot;foo&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;foo 事件被订阅了，可以发布&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

observer<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token string">&quot;bar&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;bar 事件被订阅了，可以发布&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

observer<span class="token punctuation">.</span><span class="token function">publish</span><span class="token punctuation">(</span><span class="token string">&quot;foo&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
observer<span class="token punctuation">.</span><span class="token function">publish</span><span class="token punctuation">(</span><span class="token string">&quot;bar&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h2 id="单例模式"><a href="#单例模式" class="header-anchor">#</a> 单例模式</h2> <p>单例（件）模式（Singleton）：用来创建独一无二的，只能有一个实例的对象的入场券。</p> <h3 id="原因"><a href="#原因" class="header-anchor">#</a> 原因</h3> <ul><li>线程池（threadpool）</li> <li>缓存（cache）</li> <li>对话框</li> <li>处理偏好设置和注册表（registry）的对象</li> <li>日志对象</li> <li>充当打印机</li> <li>显卡等设备的驱动程序的对象。</li></ul> <p>优点</p> <ul><li>全局变量的缺点：如果将对象赋值给一个全局变量，那么你必须在程序一开始就创建好对象。万一这个对象非常耗费资源，而程序在这次的执行过程中又一直没用到它，不就形成浪费了吗？使用单例模式，可以在需要时才创建。</li></ul> <h3 id="实现-3"><a href="#实现-3" class="header-anchor">#</a> 实现</h3> <h4 id="版本一"><a href="#版本一" class="header-anchor">#</a> 版本一</h4> <div class="language-cs line-numbers-mode"><pre class="language-cs"><code><span class="token comment">/*
 * 单例模式
 */</span>
<span class="token keyword">using</span> <span class="token namespace">System</span><span class="token punctuation">;</span>
<span class="token keyword">namespace</span> <span class="token namespace">Design<span class="token punctuation">.</span>Patterns</span>
<span class="token punctuation">{</span>
  <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Singleton</span>
  <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Singleton</span> uniqueInstance<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token function">Singleton</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name">Singleton</span> <span class="token function">GetSingleton</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>uniqueInstance <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
      <span class="token punctuation">{</span>
        uniqueInstance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Singleton</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> uniqueInstance<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> args<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>

    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><h3 id="应用场景"><a href="#应用场景" class="header-anchor">#</a> 应用场景</h3> <p>Unity MonoBehaviour 使用</p> <p>如果游戏中可以确定特定的类只有一个单一的实例，那么可以为该类创建一个单例，作为该类类型的静态变量，可以在代码的任何地方引用。下面通过静态变量的访问约定：</p> <div class="language-cs line-numbers-mode"><pre class="language-cs"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Hero</span><span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">MonoBehaviour</span></span> <span class="token punctuation">{</span>
  <span class="token keyword">static</span> <span class="token keyword">public</span> <span class="token class-name">Hero</span> S<span class="token punctuation">;</span> <span class="token comment">// 1</span>

  <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Awake</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    S <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span> <span class="token comment">// 2</span>
  <span class="token punctuation">}</span>

  <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token class-name">Vector3</span> heroLoc <span class="token operator">=</span> Hero<span class="token punctuation">.</span>S<span class="token punctuation">.</span>transform<span class="token punctuation">.</span>position<span class="token punctuation">;</span> <span class="token comment">// 3</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><ol><li>静态公共变量 S 是 hero 的单例。我命名所有自定义的单例为 S。</li> <li>因为 Hero 类只可能有一个实例，当实例被创建时 S 被分配到 <code>Awake()</code>。</li> <li>因为变量 S 是公共并且静态的，通过类名 Hero.S 可以在代码任何地方引用它。</li></ol> <h2 id="命令模式"><a href="#命令模式" class="header-anchor">#</a> 命令模式</h2> <h2 id="适配器模式"><a href="#适配器模式" class="header-anchor">#</a> 适配器模式</h2> <p><strong>适配器模式的作用是解决两个软件实体间的接口不兼容的问题。使用适配器模式之后，原本由于接口不兼容而不能工作的两个软件实体可以一起工作。</strong></p> <p>适配器的别名是包装器（wrapper），这是一个相对简单的模式。在程序开发中有许多这样的场景：当我们试图调用模块或者对象的某个接口时，却发现这个接口的格式并不符合目前的需求。这时候有两种解决方法，<u>第一种是修改原来的接口实现，但如果原来的模块很复杂，或者我们拿到的模块是一段别人编写的经过压缩的代码，修改原接口就显得不太现实了。第二种办法就是创建一个适配器，将原接口转化为客户希望的另一个接口，客户只需要和适配器打交道。</u></p> <h3 id="现实中的适配器"><a href="#现实中的适配器" class="header-anchor">#</a> 现实中的适配器</h3> <p>适配器在现实生活中的应用非常广泛，接下来我们来看几个现实生活中的适配器模式。</p> <h4 id="_1-港式插头转换器"><a href="#_1-港式插头转换器" class="header-anchor">#</a> 1. 港式插头转换器</h4> <p>港式的电器插头比大陆的电器插头体积要大一些。如果从香港买了一个 Mac book，我们会发现充电器无法插在家里的插座上，为此而改造家里的插座显然不方便，所以我们需要一个适配器：</p> <p><img src="/Notebook/assets/img/adapter-1.5d9f8789.png" alt="港式插头转换器"></p> <h4 id="_2-电源适配器"><a href="#_2-电源适配器" class="header-anchor">#</a> 2. 电源适配器</h4> <p>Mac book 电池支持的电压是 20V，我们日常生活中的交流电压一般是 220V。除了我们了解的 220V 交流电压，日本和韩国的交流电压大多是 100V，而英国和澳大利亚的是 240V。<u>笔记本电脑的电源适配器就承担了转换电压的作用，电源适配器使笔记本电脑在 100V ～ 240V 的电压之内都能正常工作，这也是它为什么被称为电源“适配器”的原因。</u></p> <p><img src="/Notebook/assets/img/adapter-2.7819cb53.png" alt="电源适配器"></p> <h4 id="_3-usb-转接口"><a href="#_3-usb-转接口" class="header-anchor">#</a> 3. USB 转接口</h4> <p>在以前的电脑上，PS2 接口是连接鼠标、键盘等其他外部设备的标准接口。但随着技术的发展，越来越多的电脑开始放弃了 PS2 接口，转而仅支持 USB 接口。所以那些过去生产出来的只拥有 PS2 接口的鼠标、键盘、游戏手柄等，<u>需要一个 USB 转接口才能继续正常工作，这是 PS2-USB 适配器诞生的原因</u>。</p> <p><img src="/Notebook/assets/img/adapter-3.27b2f2f2.png" alt="USB 转接口"></p> <p>而现在最新的 2018 mac pro 接口已经升级为了 type-c 接口，如果要外接显示器、投影仪，则需要一个适配器（type-other 集成多种设备的转接口）。</p> <h3 id="适配器模式的应用"><a href="#适配器模式的应用" class="header-anchor">#</a> 适配器模式的应用</h3> <p>如果现有的接口已经能够正常工作，那我们就永远不会用上适配器模式。<u>适配器模式是一种“亡羊补牢”的模式，没有人会在程序的设计之初就使用它。因为没有人可以完全预料到未来的事情，也许现在好好工作的接口，未来的某天却不再适用于新系统呢，那么我们用适配器模式把旧接口包装成一个新的接口，使它继续保持生命力。</u>比如在 JSON 格式流行之前，很多 cgi 返回的都是 XML 格式的数据，如果今天仍然想继续使用这些接口，显然我们可以创造一个** XML-JSON** 的适配器。</p> <p>下面这个实例可以帮助我们深刻了解适配器模式。</p> <p>回忆多态的例子，当我们向 googleMap 和 baiduMap 都发出 “显示” 请求时，googleMap 和 baiduMap 分别以各自的方式在页面中展现了地图：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> googleMap <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">show</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;开始渲染谷歌地图&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> baiduMap <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">show</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;开始渲染百度地图&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> <span class="token function-variable function">renderMap</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">map</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>map<span class="token punctuation">.</span>show <span class="token keyword">instanceof</span> <span class="token class-name">Function</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    map<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token function">renderMap</span><span class="token punctuation">(</span>googleMap<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 输出：开始渲染谷歌地图</span>
<span class="token function">renderMap</span><span class="token punctuation">(</span>baiduMaop<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 输出：开始渲染百度地图</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>这段程序得以顺利运行的关键是 googleMap 和 baiduMap 提供了一致的 show 方法，但第三方的接口方法并不在我们自己的控制范围之内，假如 baiduMap 提供的显示地图的方法不叫 show 而叫 display 呢？</p> <p>baidu 这个对象来源于第三方，正常情况下我们都不应该去改动它。此时我们可以通过增加 <code>baiduMapAdapter</code> 来解决问题：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> googleMap <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">show</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;开始渲染谷歌地图&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> baiduMap <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">display</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;开始渲染百度地图&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> baiduMapAdater <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">show</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> baiduMap<span class="token punctuation">.</span><span class="token function">display</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token function">renderMap</span><span class="token punctuation">(</span>googleMap<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 输出：开始渲染谷歌地图</span>
<span class="token function">renderMap</span><span class="token punctuation">(</span>baiduMapAdapter<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 输出：开始渲染百度地图</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>再来看看另外一个例子。假设我们正在编写一个渲染广东省地图的页面。目前从第三方资源里获得了广东省的所有城市以及它们所对应的 ID，并且成功地渲染到页面中：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> <span class="token function-variable function">getGoungdongCity</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> guangdongCity <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      name<span class="token operator">:</span> <span class="token string">&quot;shenzhen&quot;</span><span class="token punctuation">,</span>
      id<span class="token operator">:</span> <span class="token number">11</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      name<span class="token operator">:</span> <span class="token string">&quot;guangzhou&quot;</span><span class="token punctuation">,</span>
      id<span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> guangdongCity<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> <span class="token function-variable function">render</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;开始渲染广东省地图&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  document<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token function">render</span><span class="token punctuation">(</span><span class="token function">getGoungdongCity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>利用这些数据，我们编写完成了整个页面，并且在线上稳定地运行了一段时间。但后来发现这些数据不太可靠，里面还缺少了很多城市。<u>于是我们又在网上找到了另外一些数据资源，这次的数据更加全面，但遗憾的是。数据结构和正运行在项目中的并不一致。</u>新的数据结构如下：(PS：在项目中树的结构是很常见的，很多时候前端在获取后台的数据都要进行处理，以便符合现有的树组件的数据结构，也就是使用了适配器。)</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> guangdongCity <span class="token operator">=</span> <span class="token punctuation">{</span>
  shenzhen<span class="token operator">:</span> <span class="token number">11</span><span class="token punctuation">,</span>
  guangzhou<span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span>
  zhuhai<span class="token operator">:</span> <span class="token number">13</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>除了大动干戈地改写渲染页面的前端代码之外，<u>另外一种更轻便的解决方式就是新增一个数据格式转换的适配器：</u></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> <span class="token function-variable function">getGoungdongCity</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> guangdongCity <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      name<span class="token operator">:</span> <span class="token string">&quot;shenzhen&quot;</span><span class="token punctuation">,</span>
      id<span class="token operator">:</span> <span class="token number">11</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      name<span class="token operator">:</span> <span class="token string">&quot;guangzhou&quot;</span><span class="token punctuation">,</span>
      id<span class="token operator">:</span> <span class="token number">12</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> guangdongCity<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 由一个对象来包装另一个对象。</span>
<span class="token keyword">var</span> <span class="token function-variable function">adddressAdapter</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">oldAddressfn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> address <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> oldAress <span class="token operator">=</span> <span class="token function">oldAddressfn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> c<span class="token punctuation">;</span> c <span class="token operator">=</span> oldAddress<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    address<span class="token punctuation">[</span>c<span class="token punctuation">.</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> c<span class="token punctuation">.</span>id<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token keyword">return</span> address<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token function">render</span><span class="token punctuation">(</span> <span class="token function">addressAdapter</span><span class="token punctuation">(</span>getGuangdongCity<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br></div></div><p>那么接下来需要做的，就是把代码中调用 <code>getGuangdongCity</code> 的地方，用经过 <code>addressAdapter</code> 适配器转换之后的新函数来代替。</p> <h4 id="实战"><a href="#实战" class="header-anchor">#</a> 实战</h4> <p>这里就是一个简单适配器处理了，如果很多获取的接口数据都需要这样处理的话，就可以新增一个树的适配器处理。</p> <p>Before</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">private</span> <span class="token keyword">async</span> <span class="token function">InitGetDalx</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 获取后台数据</span>
    <span class="token keyword">const</span> dalxs <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getArchiveTypeTree</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// console.log(dalxs);</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>dalxs <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$lodash<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>dalxs<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>dalxs <span class="token keyword">as</span> <span class="token builtin">any</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>archiveTypes <span class="token operator">=</span> dalxs <span class="token keyword">as</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token comment">// 处理数据，适配处理</span>
      <span class="token keyword">const</span> <span class="token function-variable function">walkData</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">data<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        data<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          item<span class="token punctuation">.</span>title <span class="token operator">=</span> item<span class="token punctuation">.</span>name<span class="token punctuation">;</span> <span class="token comment">//</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>item<span class="token punctuation">.</span>children<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">walkData</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>children<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token function">walkData</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>archiveTypes<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>After</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">private</span> <span class="token keyword">async</span> <span class="token function">treeAdapter</span><span class="token punctuation">(</span><span class="token parameter">fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 获取后台数据</span>
    <span class="token keyword">const</span> oldata <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>oldata <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$lodash<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>oldata<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>oldata <span class="token keyword">as</span> <span class="token builtin">any</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      data <span class="token operator">=</span> oldata <span class="token keyword">as</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token comment">// 处理数据，适配处理</span>
      <span class="token keyword">const</span> <span class="token function-variable function">walkData</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">data<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        data<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          item<span class="token punctuation">.</span>title <span class="token operator">=</span> item<span class="token punctuation">.</span>name<span class="token punctuation">;</span> <span class="token comment">//</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>item<span class="token punctuation">.</span>children<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">walkData</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>children<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token function">walkData</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 这里看 render 的需要，需要返回函数的话，就这样封装起来。否则也可直接 return data。</span>
      <span class="token keyword">return</span> data<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token comment">// 渲染</span>
<span class="token function">render</span><span class="token punctuation">(</span> <span class="token function">treeAdapter</span><span class="token punctuation">(</span>getArchiveTypeTree<span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><h3 id="小结"><a href="#小结" class="header-anchor">#</a> 小结</h3> <p>适配器模式是一对相对简单的模式。有一些设计模式跟适配器模式结构非常相似，比如装饰者模式、代理模式和外观模式。<u>这几种模式都属于“包装模式”，都是由一个对象来包装另一个对象。</u><strong>区别它们的关键仍然是模式的意图。</strong></p> <ul><li><u>适配器模式主要用来解决两个已有接口之间不匹配的问题，它不考虑这些接口是怎样实现的，也不考虑它们将来可能会如何演化。</u>适配器模式不需要改变已有的接口，就能够使它们协同作用。</li> <li>装饰器模式和代理模式也不会改变原有对象的接口，<u>但是装饰器模式的作用是为了给对象增加功能。</u>装饰者模式常常形成一条长的装饰链，而适配器模式通常只包装一次。代理模式是为了恐难治对对象的访问，通常也只包装一次。</li> <li>外观模式的作用倒是和适配器比较相似，有人把外观模式看成一组对象的适配器，<u>但外观模式最显著的特点是定义了一个新的接口。</u></li></ul> <h3 id="策略模式"><a href="#策略模式" class="header-anchor">#</a> 策略模式</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code>  <span class="token keyword">private</span> <span class="token keyword">async</span> <span class="token function">DrillDown</span><span class="token punctuation">(</span><span class="token parameter">currentNode<span class="token operator">:</span> any</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 根据节点角色类型，安排不同的请求策略</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> archiveId<span class="token punctuation">,</span> archiveNodeId <span class="token punctuation">}</span> <span class="token operator">=</span> currentNode<span class="token punctuation">;</span>
    <span class="token comment">// 2. 下钻策略配置</span>
    <span class="token keyword">const</span> drillRequestConfig <span class="token operator">=</span> <span class="token punctuation">{</span>
      <span class="token comment">// 档案</span>
      <span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>enumRoleType<span class="token punctuation">.</span>archive<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
       <span class="token comment">//</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token comment">// 档案文件</span>
      <span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>enumRoleType<span class="token punctuation">.</span>archiveFile<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
       <span class="token comment">//</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token comment">// 档案节点</span>
      <span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>enumRoleType<span class="token punctuation">.</span>archiveNode<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">//</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
   <span class="token comment">// 1. 执行上下文</span>
    <span class="token keyword">const</span> <span class="token function-variable function">contextExecute</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">nodeRole<span class="token operator">:</span> number</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> drillRequestConfig<span class="token punctuation">[</span>nodeRole<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">const</span> <span class="token punctuation">{</span> nodeRole <span class="token punctuation">}</span> <span class="token operator">=</span> currentNode<span class="token punctuation">;</span>
    <span class="token comment">// 3. 外部调用</span>
    <span class="token keyword">await</span> <span class="token function">contextExecute</span><span class="token punctuation">(</span>nodeRole<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 执行下钻策略</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><p>在 C# 中，是通过函数委托来实现策略模式的。</p> <h3 id="行为型：状态模式"><a href="#行为型：状态模式" class="header-anchor">#</a> 行为型：状态模式</h3> <h3 id="基本示例-自助咖啡机背后的力量"><a href="#基本示例-自助咖啡机背后的力量" class="header-anchor">#</a> 基本示例——自助咖啡机背后的力量</h3> <h3 id="真实场景"><a href="#真实场景" class="header-anchor">#</a> 真实场景</h3> <h3 id="与策略模式辨析"><a href="#与策略模式辨析" class="header-anchor">#</a> 与策略模式辨析</h3> <p>策略模式和状态模式确实是相似的，它们都封装行为、都通过委托来实现分发。</p> <p>但策略模式中的行为函数不依赖<strong>调用主体</strong>、互相平行、各自为政。而状态模式中的行为函数，首先是和状态主体之间存着关联，由状态主体把它们串在一起；另一方面，正因为关联着同样的一个（或一类）主体，所以不同状态对应的行为函数可能并不会特别割裂。</p> <h3 id="状态模式复盘"><a href="#状态模式复盘" class="header-anchor">#</a> 状态模式复盘</h3> <blockquote><p>状态模式主要解决的是当控制一个对象状态的条件表达式过于复杂时的情况。把状态的判断逻辑转移到表示不同状态的一系列类中，可以把复杂的判断逻辑简化。</p></blockquote> <p>唯一的区别在于，定义里强调了“类”的概念。但我们的示例中，包括今后的实践中，一个对象的状态如果复杂到了你不得不给它的每 N 种状态划分为一类、一口气划分很多类程度，我们要反思这个对象是不是做太多事情了。在大多数场景下，我们的行为划分，都是可以像本节一样，控制在“函数”这个粒度的。</p> <p>TODO 状态机模式，还需要进一步看下《HeadFirst 设计模式》 的处理。</p> <p>案例：规划审查，流程审查状态。</p> <ul><li>复杂的流程控制</li> <li>上传文件</li></ul> <h4 id="uml-图-状态机"><a href="#uml-图-状态机" class="header-anchor">#</a> UML 图-状态机</h4> <h2 id="行为型：观察者模式"><a href="#行为型：观察者模式" class="header-anchor">#</a> 行为型：观察者模式</h2> <blockquote><p>观察者模式定义了一种一对多的依赖关系，让多个观察者对象同时监听某一个目标对象，当这个目标对象的状态发生变化时，会通知所有观察者对象，使它们能够自我更新。</p></blockquote> <p>角色划分 --&gt; 状态变化 --&gt; 发布者通知到订阅者，这就是观察者模式的“套路”。</p> <h3 id="真实示例"><a href="#真实示例" class="header-anchor">#</a> 真实示例</h3> <h4 id="vue-数据双向绑定的实现原理"><a href="#vue-数据双向绑定的实现原理" class="header-anchor">#</a> Vue 数据双向绑定的实现原理</h4> <p>在 Vue 数据双向绑定的实现逻辑里，有这样三个关键角色：</p> <ul><li><strong>observer（监听器）</strong>：注意，此 observer 并非彼 observer。在我们上节的解析中，observer 作为设计模式中的一个角色，代表“订阅者”。但在 Vue 数据双向绑定的角色结构里，所谓的 observer 不仅是一个数据监听器，它还需要对监听到的数据进行<strong>转发</strong>——也就是说它<strong>同时还是一个发布者</strong>。</li> <li><strong>watcher（订阅者）</strong>：observer 把数据转发给了<strong>真正的订阅者</strong>——watcher 对象。watcher 接收到新的数据后，会去更新视图。</li> <li><strong>complie（编译器）</strong>：MVVM 框架特有的角色，负责对每个节点元素指令进行扫描和解析，指令的数据初始化、订阅者的创建这些“杂活”也归它管。</li></ul> <p><img src="/Notebook/assets/img/2020-11-09-20-49-32.d99fcb63.png" alt=""></p> <p>学有余力的同学，推荐阅读 FaceBook 推出的通用 <a href="https://github.com/facebookarchive/emitter" target="_blank" rel="noopener noreferrer">EventEmiiter<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 库的源码，相信你会有更多收获。</p> <h3 id="观察者模式与发布-订阅模式的区别是什么"><a href="#观察者模式与发布-订阅模式的区别是什么" class="header-anchor">#</a> 观察者模式与发布-订阅模式的区别是什么</h3> <p>韩梅梅把所有的开发者拉了一个群，直接把需求文档丢给每一位群成员，这种<strong>发布者直接触及到订阅者</strong>的操作，叫观察者模式。但如果韩梅梅没有拉群，而是把需求文档上传到了公司统一的需求平台上，需求平台感知到文件的变化，自动通知了每一位订阅了该文件的开发者，这种<strong>发布者不直接触及到订阅者、而是由统一的第三方来完成实际的通信的操作，叫做发布-订阅模式。</strong></p> <p><img src="/Notebook/assets/img/2020-11-09-21-18-28.df2024c0.png" alt=""></p> <p><img src="/Notebook/assets/img/2020-11-09-21-18-35.24748256.png" alt=""></p> <p>为什么要有观察者模式？观察者模式，解决的其实是模块见间的耦合问题，有它在，即便是两个分离的、毫不相关的模块，也可以实现数据通信。但观察者模式仅仅是减少了耦合，<strong>并没有完全地解决耦合问题</strong>——被观察者必须去维护一套观察者的集合，<u>这些观察者必须实现统一的方法供被观察者调用</u>，两者之间还是有着说不清、道不明的关系。</p> <p>而发布——订阅模式，发布者完全不用感知订阅者，不用关心它怎么实现回调方法，事件的注册和触发都发生在独立于双方的第三方平台（事件总线）上。发布—订阅模式下，实现了完全地解耦。</p> <p>但这并不意味着，发布-订阅模式就比观察者模式“高级”。在实际开发中，我们的模块解藕诉求**并非总是需求它们完全解耦。**如果两个模块之间本身存在关联，且这种关联是稳定的、必要的，那么我们使用观察者模式就足够了。而在模块与模块之间独立性较强、且没有必要单纯为了数据通信而强行为两者制造依赖的情况下，我们往往会倾向于使用发布——订阅模式。</p> <h2 id="参考资料"><a href="#参考资料" class="header-anchor">#</a> 参考资料</h2> <ul><li>《JavaScript 设计模式与开发实践》</li> <li><a href="https://juejin.im/book/6844733790204461070/section/6844733790246404109" target="_blank" rel="noopener noreferrer">JavaScript 设计模式核⼼原理与应⽤实践<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://juejin.im/post/6856517315010232333#heading-8" target="_blank" rel="noopener noreferrer">在 Vue 中使用装饰器，我是认真的<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>《HeadFirst 设计模式》</li> <li><a href="https://mp.weixin.qq.com/s/2UYXNzgTCEZdEfuGIbcczA" target="_blank" rel="noopener noreferrer">漫画：什么是单例模式？（整合版）<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">4/8/2021, 5:54:27 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/Notebook/algorithm/algorithm.html" class="prev">
        算法分类
      </a></span> <!----></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/Notebook/assets/js/app.139a155b.js" defer></script><script src="/Notebook/assets/js/4.e8b70bd9.js" defer></script><script src="/Notebook/assets/js/24.84834785.js" defer></script>
  </body>
</html>
