<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>程序员内功——进程与线程、协程 | Naluduo&#39;s Notebook</title>
    <meta name="generator" content="VuePress 1.5.0">
    <link rel="icon" href="/Notebook/images/logo.jpeg">
    <meta name="description" content="📝每天记录一点点">
    <link rel="preload" href="/Notebook/assets/css/0.styles.8f4327af.css" as="style"><link rel="preload" href="/Notebook/assets/js/app.139a155b.js" as="script"><link rel="preload" href="/Notebook/assets/js/4.e8b70bd9.js" as="script"><link rel="preload" href="/Notebook/assets/js/27.23c0d0bb.js" as="script"><link rel="prefetch" href="/Notebook/assets/js/10.1fae0c9b.js"><link rel="prefetch" href="/Notebook/assets/js/100.d0da51c4.js"><link rel="prefetch" href="/Notebook/assets/js/101.f5af623a.js"><link rel="prefetch" href="/Notebook/assets/js/102.b3d42b74.js"><link rel="prefetch" href="/Notebook/assets/js/103.8f17785a.js"><link rel="prefetch" href="/Notebook/assets/js/104.056d18e2.js"><link rel="prefetch" href="/Notebook/assets/js/105.50f362f2.js"><link rel="prefetch" href="/Notebook/assets/js/106.2293abd8.js"><link rel="prefetch" href="/Notebook/assets/js/107.776d74d9.js"><link rel="prefetch" href="/Notebook/assets/js/108.562a5345.js"><link rel="prefetch" href="/Notebook/assets/js/109.9897ab89.js"><link rel="prefetch" href="/Notebook/assets/js/11.c1323ed6.js"><link rel="prefetch" href="/Notebook/assets/js/110.5986b585.js"><link rel="prefetch" href="/Notebook/assets/js/111.163a9a13.js"><link rel="prefetch" href="/Notebook/assets/js/112.ab7e15ac.js"><link rel="prefetch" href="/Notebook/assets/js/113.11bd753c.js"><link rel="prefetch" href="/Notebook/assets/js/114.53962168.js"><link rel="prefetch" href="/Notebook/assets/js/115.3a5ada66.js"><link rel="prefetch" href="/Notebook/assets/js/116.cf65da6f.js"><link rel="prefetch" href="/Notebook/assets/js/117.26108558.js"><link rel="prefetch" href="/Notebook/assets/js/118.aa336fda.js"><link rel="prefetch" href="/Notebook/assets/js/119.7ceb5577.js"><link rel="prefetch" href="/Notebook/assets/js/12.4e58256f.js"><link rel="prefetch" href="/Notebook/assets/js/120.4f14c30d.js"><link rel="prefetch" href="/Notebook/assets/js/121.19f5571d.js"><link rel="prefetch" href="/Notebook/assets/js/122.1d0669c3.js"><link rel="prefetch" href="/Notebook/assets/js/123.a7f30f7e.js"><link rel="prefetch" href="/Notebook/assets/js/124.fff11adb.js"><link rel="prefetch" href="/Notebook/assets/js/125.b56646a4.js"><link rel="prefetch" href="/Notebook/assets/js/126.1c59b3bd.js"><link rel="prefetch" href="/Notebook/assets/js/127.fcb506e8.js"><link rel="prefetch" href="/Notebook/assets/js/128.5b580b8f.js"><link rel="prefetch" href="/Notebook/assets/js/129.84ae003a.js"><link rel="prefetch" href="/Notebook/assets/js/13.1c4e6be1.js"><link rel="prefetch" href="/Notebook/assets/js/130.6dcaf514.js"><link rel="prefetch" href="/Notebook/assets/js/131.a42f7c47.js"><link rel="prefetch" href="/Notebook/assets/js/132.04f8a016.js"><link rel="prefetch" href="/Notebook/assets/js/133.57281f84.js"><link rel="prefetch" href="/Notebook/assets/js/134.ecd654d6.js"><link rel="prefetch" href="/Notebook/assets/js/135.63a2dbad.js"><link rel="prefetch" href="/Notebook/assets/js/136.d99e29b3.js"><link rel="prefetch" href="/Notebook/assets/js/137.50d7b01d.js"><link rel="prefetch" href="/Notebook/assets/js/138.4390b86c.js"><link rel="prefetch" href="/Notebook/assets/js/139.2d9ce853.js"><link rel="prefetch" href="/Notebook/assets/js/14.0443782b.js"><link rel="prefetch" href="/Notebook/assets/js/140.4a2047e8.js"><link rel="prefetch" href="/Notebook/assets/js/141.b3704c9c.js"><link rel="prefetch" href="/Notebook/assets/js/142.4d142b47.js"><link rel="prefetch" href="/Notebook/assets/js/143.f15872bb.js"><link rel="prefetch" href="/Notebook/assets/js/144.679f0a2d.js"><link rel="prefetch" href="/Notebook/assets/js/145.2106194a.js"><link rel="prefetch" href="/Notebook/assets/js/146.605f3d79.js"><link rel="prefetch" href="/Notebook/assets/js/147.3682320c.js"><link rel="prefetch" href="/Notebook/assets/js/148.cbcbff7e.js"><link rel="prefetch" href="/Notebook/assets/js/149.c2a26094.js"><link rel="prefetch" href="/Notebook/assets/js/15.de1f84e8.js"><link rel="prefetch" href="/Notebook/assets/js/150.0086324a.js"><link rel="prefetch" href="/Notebook/assets/js/151.5f722522.js"><link rel="prefetch" href="/Notebook/assets/js/152.d3eaf2c8.js"><link rel="prefetch" href="/Notebook/assets/js/153.a1864660.js"><link rel="prefetch" href="/Notebook/assets/js/154.d1ae6046.js"><link rel="prefetch" href="/Notebook/assets/js/155.eb0fccff.js"><link rel="prefetch" href="/Notebook/assets/js/156.9db0381e.js"><link rel="prefetch" href="/Notebook/assets/js/157.0b4984af.js"><link rel="prefetch" href="/Notebook/assets/js/158.43189b18.js"><link rel="prefetch" href="/Notebook/assets/js/159.812f06b9.js"><link rel="prefetch" href="/Notebook/assets/js/16.2ea274b4.js"><link rel="prefetch" href="/Notebook/assets/js/160.1f44d433.js"><link rel="prefetch" href="/Notebook/assets/js/161.21852224.js"><link rel="prefetch" href="/Notebook/assets/js/162.9bb18d96.js"><link rel="prefetch" href="/Notebook/assets/js/163.0d4bb60d.js"><link rel="prefetch" href="/Notebook/assets/js/164.5ddcb334.js"><link rel="prefetch" href="/Notebook/assets/js/165.4c394b31.js"><link rel="prefetch" href="/Notebook/assets/js/166.62ee9f20.js"><link rel="prefetch" href="/Notebook/assets/js/167.3c668713.js"><link rel="prefetch" href="/Notebook/assets/js/168.bae89f34.js"><link rel="prefetch" href="/Notebook/assets/js/169.efed8b05.js"><link rel="prefetch" href="/Notebook/assets/js/17.881f6ab6.js"><link rel="prefetch" href="/Notebook/assets/js/170.3d8e1b73.js"><link rel="prefetch" href="/Notebook/assets/js/171.2c9b4191.js"><link rel="prefetch" href="/Notebook/assets/js/172.7dda8427.js"><link rel="prefetch" href="/Notebook/assets/js/173.ce6698c1.js"><link rel="prefetch" href="/Notebook/assets/js/174.1ee6dc45.js"><link rel="prefetch" href="/Notebook/assets/js/175.77f2eea7.js"><link rel="prefetch" href="/Notebook/assets/js/176.fbb0fa4e.js"><link rel="prefetch" href="/Notebook/assets/js/177.82817bff.js"><link rel="prefetch" href="/Notebook/assets/js/178.616bd587.js"><link rel="prefetch" href="/Notebook/assets/js/179.6dc3a213.js"><link rel="prefetch" href="/Notebook/assets/js/18.0e13bc5c.js"><link rel="prefetch" href="/Notebook/assets/js/180.55c85341.js"><link rel="prefetch" href="/Notebook/assets/js/181.fc3d81b6.js"><link rel="prefetch" href="/Notebook/assets/js/182.8790a49f.js"><link rel="prefetch" href="/Notebook/assets/js/183.22912b56.js"><link rel="prefetch" href="/Notebook/assets/js/184.a3cc6104.js"><link rel="prefetch" href="/Notebook/assets/js/185.8bad0700.js"><link rel="prefetch" href="/Notebook/assets/js/186.9aca737e.js"><link rel="prefetch" href="/Notebook/assets/js/187.1465e2fb.js"><link rel="prefetch" href="/Notebook/assets/js/188.bd29e48b.js"><link rel="prefetch" href="/Notebook/assets/js/189.0d6a0652.js"><link rel="prefetch" href="/Notebook/assets/js/19.a428bfa6.js"><link rel="prefetch" href="/Notebook/assets/js/190.c8ff6ab9.js"><link rel="prefetch" href="/Notebook/assets/js/191.116dc665.js"><link rel="prefetch" href="/Notebook/assets/js/192.3d558a9e.js"><link rel="prefetch" href="/Notebook/assets/js/193.4d856925.js"><link rel="prefetch" href="/Notebook/assets/js/194.85e0627b.js"><link rel="prefetch" href="/Notebook/assets/js/195.ad78bbd6.js"><link rel="prefetch" href="/Notebook/assets/js/196.8c7c9b72.js"><link rel="prefetch" href="/Notebook/assets/js/197.447f0a00.js"><link rel="prefetch" href="/Notebook/assets/js/198.cfabe606.js"><link rel="prefetch" href="/Notebook/assets/js/199.89482b48.js"><link rel="prefetch" href="/Notebook/assets/js/2.17a0eab0.js"><link rel="prefetch" href="/Notebook/assets/js/20.3106c5a5.js"><link rel="prefetch" href="/Notebook/assets/js/200.c186e0f9.js"><link rel="prefetch" href="/Notebook/assets/js/201.b6bfc826.js"><link rel="prefetch" href="/Notebook/assets/js/202.c1f56d61.js"><link rel="prefetch" href="/Notebook/assets/js/203.55fe1aa3.js"><link rel="prefetch" href="/Notebook/assets/js/204.ebd5e2d4.js"><link rel="prefetch" href="/Notebook/assets/js/205.71b72bf6.js"><link rel="prefetch" href="/Notebook/assets/js/206.bd18bc7f.js"><link rel="prefetch" href="/Notebook/assets/js/207.d4d69acd.js"><link rel="prefetch" href="/Notebook/assets/js/208.222b7876.js"><link rel="prefetch" href="/Notebook/assets/js/209.f25452d4.js"><link rel="prefetch" href="/Notebook/assets/js/21.76dba99d.js"><link rel="prefetch" href="/Notebook/assets/js/210.3393aed8.js"><link rel="prefetch" href="/Notebook/assets/js/211.fb8cb7a1.js"><link rel="prefetch" href="/Notebook/assets/js/212.344d00e0.js"><link rel="prefetch" href="/Notebook/assets/js/213.a51629c4.js"><link rel="prefetch" href="/Notebook/assets/js/214.d97e28ee.js"><link rel="prefetch" href="/Notebook/assets/js/215.66576ead.js"><link rel="prefetch" href="/Notebook/assets/js/216.cbd47b9d.js"><link rel="prefetch" href="/Notebook/assets/js/217.115d7a12.js"><link rel="prefetch" href="/Notebook/assets/js/218.d1b6e62f.js"><link rel="prefetch" href="/Notebook/assets/js/219.f2bf2e5f.js"><link rel="prefetch" href="/Notebook/assets/js/22.a03922de.js"><link rel="prefetch" href="/Notebook/assets/js/220.8df2573e.js"><link rel="prefetch" href="/Notebook/assets/js/221.3d8ee874.js"><link rel="prefetch" href="/Notebook/assets/js/222.8a4e6ab3.js"><link rel="prefetch" href="/Notebook/assets/js/223.e8f7051b.js"><link rel="prefetch" href="/Notebook/assets/js/224.f864e8f4.js"><link rel="prefetch" href="/Notebook/assets/js/225.30413761.js"><link rel="prefetch" href="/Notebook/assets/js/226.c2f2286f.js"><link rel="prefetch" href="/Notebook/assets/js/227.d7346a90.js"><link rel="prefetch" href="/Notebook/assets/js/228.6066eeb2.js"><link rel="prefetch" href="/Notebook/assets/js/229.0102fdc3.js"><link rel="prefetch" href="/Notebook/assets/js/23.685dee89.js"><link rel="prefetch" href="/Notebook/assets/js/230.c21b14f8.js"><link rel="prefetch" href="/Notebook/assets/js/231.9165f00e.js"><link rel="prefetch" href="/Notebook/assets/js/232.a7474466.js"><link rel="prefetch" href="/Notebook/assets/js/233.667bd498.js"><link rel="prefetch" href="/Notebook/assets/js/234.b7eb4d16.js"><link rel="prefetch" href="/Notebook/assets/js/235.0edef63f.js"><link rel="prefetch" href="/Notebook/assets/js/236.076754ee.js"><link rel="prefetch" href="/Notebook/assets/js/237.6527bc02.js"><link rel="prefetch" href="/Notebook/assets/js/238.7aa882f3.js"><link rel="prefetch" href="/Notebook/assets/js/239.71ad3f6e.js"><link rel="prefetch" href="/Notebook/assets/js/24.84834785.js"><link rel="prefetch" href="/Notebook/assets/js/240.42d36cc0.js"><link rel="prefetch" href="/Notebook/assets/js/241.fba85183.js"><link rel="prefetch" href="/Notebook/assets/js/242.d652773d.js"><link rel="prefetch" href="/Notebook/assets/js/243.dd6c78c5.js"><link rel="prefetch" href="/Notebook/assets/js/244.da300c6d.js"><link rel="prefetch" href="/Notebook/assets/js/245.1ab30248.js"><link rel="prefetch" href="/Notebook/assets/js/246.b1de7d1b.js"><link rel="prefetch" href="/Notebook/assets/js/247.17c60f57.js"><link rel="prefetch" href="/Notebook/assets/js/248.f3e9919e.js"><link rel="prefetch" href="/Notebook/assets/js/249.9b68ff42.js"><link rel="prefetch" href="/Notebook/assets/js/25.9c4dea8d.js"><link rel="prefetch" href="/Notebook/assets/js/250.20e586ab.js"><link rel="prefetch" href="/Notebook/assets/js/251.91974a71.js"><link rel="prefetch" href="/Notebook/assets/js/252.4b90ead2.js"><link rel="prefetch" href="/Notebook/assets/js/253.49a92048.js"><link rel="prefetch" href="/Notebook/assets/js/254.8abd7868.js"><link rel="prefetch" href="/Notebook/assets/js/255.874d4cfe.js"><link rel="prefetch" href="/Notebook/assets/js/256.c42da90b.js"><link rel="prefetch" href="/Notebook/assets/js/257.574a4463.js"><link rel="prefetch" href="/Notebook/assets/js/258.9dfecce5.js"><link rel="prefetch" href="/Notebook/assets/js/259.5fb8371d.js"><link rel="prefetch" href="/Notebook/assets/js/26.de8bed1f.js"><link rel="prefetch" href="/Notebook/assets/js/260.8cb0b9f2.js"><link rel="prefetch" href="/Notebook/assets/js/261.0320ad16.js"><link rel="prefetch" href="/Notebook/assets/js/262.7db236d1.js"><link rel="prefetch" href="/Notebook/assets/js/263.968b439e.js"><link rel="prefetch" href="/Notebook/assets/js/264.50a7aa29.js"><link rel="prefetch" href="/Notebook/assets/js/265.71a06556.js"><link rel="prefetch" href="/Notebook/assets/js/266.6c59b012.js"><link rel="prefetch" href="/Notebook/assets/js/267.aeb43b9d.js"><link rel="prefetch" href="/Notebook/assets/js/268.a2929ce6.js"><link rel="prefetch" href="/Notebook/assets/js/269.26707ae0.js"><link rel="prefetch" href="/Notebook/assets/js/270.b8610d2f.js"><link rel="prefetch" href="/Notebook/assets/js/271.bda5e283.js"><link rel="prefetch" href="/Notebook/assets/js/272.e49151e7.js"><link rel="prefetch" href="/Notebook/assets/js/273.4cfeb2d1.js"><link rel="prefetch" href="/Notebook/assets/js/274.60fe8724.js"><link rel="prefetch" href="/Notebook/assets/js/275.b5514094.js"><link rel="prefetch" href="/Notebook/assets/js/276.202e3526.js"><link rel="prefetch" href="/Notebook/assets/js/277.26e46a71.js"><link rel="prefetch" href="/Notebook/assets/js/278.1c447532.js"><link rel="prefetch" href="/Notebook/assets/js/279.0b5e7a7b.js"><link rel="prefetch" href="/Notebook/assets/js/28.6f6d2ce9.js"><link rel="prefetch" href="/Notebook/assets/js/280.ba75d1ae.js"><link rel="prefetch" href="/Notebook/assets/js/281.b38f3748.js"><link rel="prefetch" href="/Notebook/assets/js/282.40c8513b.js"><link rel="prefetch" href="/Notebook/assets/js/283.a9392d6d.js"><link rel="prefetch" href="/Notebook/assets/js/284.d27a365f.js"><link rel="prefetch" href="/Notebook/assets/js/285.a628a15e.js"><link rel="prefetch" href="/Notebook/assets/js/286.fd9e7c31.js"><link rel="prefetch" href="/Notebook/assets/js/287.7a9f259d.js"><link rel="prefetch" href="/Notebook/assets/js/288.739670c2.js"><link rel="prefetch" href="/Notebook/assets/js/289.f98fd683.js"><link rel="prefetch" href="/Notebook/assets/js/29.d2e43523.js"><link rel="prefetch" href="/Notebook/assets/js/290.a16d65aa.js"><link rel="prefetch" href="/Notebook/assets/js/291.fc9bd002.js"><link rel="prefetch" href="/Notebook/assets/js/292.118fe91a.js"><link rel="prefetch" href="/Notebook/assets/js/293.6f1d9c68.js"><link rel="prefetch" href="/Notebook/assets/js/294.0bcb5275.js"><link rel="prefetch" href="/Notebook/assets/js/295.7b0fad94.js"><link rel="prefetch" href="/Notebook/assets/js/296.9f9712a5.js"><link rel="prefetch" href="/Notebook/assets/js/297.7febdd59.js"><link rel="prefetch" href="/Notebook/assets/js/298.3675462a.js"><link rel="prefetch" href="/Notebook/assets/js/299.10b010f0.js"><link rel="prefetch" href="/Notebook/assets/js/3.d4ed84ce.js"><link rel="prefetch" href="/Notebook/assets/js/30.7c1f3583.js"><link rel="prefetch" href="/Notebook/assets/js/300.115bd53b.js"><link rel="prefetch" href="/Notebook/assets/js/301.fabbbf0b.js"><link rel="prefetch" href="/Notebook/assets/js/302.57b83223.js"><link rel="prefetch" href="/Notebook/assets/js/303.4e639a46.js"><link rel="prefetch" href="/Notebook/assets/js/304.a35644ff.js"><link rel="prefetch" href="/Notebook/assets/js/305.20d8bbbe.js"><link rel="prefetch" href="/Notebook/assets/js/306.7253f469.js"><link rel="prefetch" href="/Notebook/assets/js/307.75c667f4.js"><link rel="prefetch" href="/Notebook/assets/js/308.f263e4b6.js"><link rel="prefetch" href="/Notebook/assets/js/309.db89dce5.js"><link rel="prefetch" href="/Notebook/assets/js/31.46a6d02f.js"><link rel="prefetch" href="/Notebook/assets/js/310.daa82fee.js"><link rel="prefetch" href="/Notebook/assets/js/311.8412981b.js"><link rel="prefetch" href="/Notebook/assets/js/312.525a26b3.js"><link rel="prefetch" href="/Notebook/assets/js/313.2ebb5383.js"><link rel="prefetch" href="/Notebook/assets/js/32.e657ae7e.js"><link rel="prefetch" href="/Notebook/assets/js/33.8425ca14.js"><link rel="prefetch" href="/Notebook/assets/js/34.e266fc3a.js"><link rel="prefetch" href="/Notebook/assets/js/35.189d30e1.js"><link rel="prefetch" href="/Notebook/assets/js/36.e60ffce6.js"><link rel="prefetch" href="/Notebook/assets/js/37.abdfdc7c.js"><link rel="prefetch" href="/Notebook/assets/js/38.b04368b3.js"><link rel="prefetch" href="/Notebook/assets/js/39.d2adf2bf.js"><link rel="prefetch" href="/Notebook/assets/js/40.35f710b4.js"><link rel="prefetch" href="/Notebook/assets/js/41.8815f14f.js"><link rel="prefetch" href="/Notebook/assets/js/42.f427aa0a.js"><link rel="prefetch" href="/Notebook/assets/js/43.ac86c129.js"><link rel="prefetch" href="/Notebook/assets/js/44.7dec7c54.js"><link rel="prefetch" href="/Notebook/assets/js/45.5fb385e5.js"><link rel="prefetch" href="/Notebook/assets/js/46.33c8a4cd.js"><link rel="prefetch" href="/Notebook/assets/js/47.dd20eb6f.js"><link rel="prefetch" href="/Notebook/assets/js/48.584b92ce.js"><link rel="prefetch" href="/Notebook/assets/js/49.041711a1.js"><link rel="prefetch" href="/Notebook/assets/js/5.b5d0cdd7.js"><link rel="prefetch" href="/Notebook/assets/js/50.8abc2f33.js"><link rel="prefetch" href="/Notebook/assets/js/51.89c79440.js"><link rel="prefetch" href="/Notebook/assets/js/52.34920dcb.js"><link rel="prefetch" href="/Notebook/assets/js/53.fc9689ee.js"><link rel="prefetch" href="/Notebook/assets/js/54.3e6daef2.js"><link rel="prefetch" href="/Notebook/assets/js/55.04dc507e.js"><link rel="prefetch" href="/Notebook/assets/js/56.38a79a77.js"><link rel="prefetch" href="/Notebook/assets/js/57.1a819b05.js"><link rel="prefetch" href="/Notebook/assets/js/58.24921926.js"><link rel="prefetch" href="/Notebook/assets/js/59.cb6c3a52.js"><link rel="prefetch" href="/Notebook/assets/js/6.4ad1c19d.js"><link rel="prefetch" href="/Notebook/assets/js/60.bd7eaa9a.js"><link rel="prefetch" href="/Notebook/assets/js/61.fb5959a5.js"><link rel="prefetch" href="/Notebook/assets/js/62.4ca2a61c.js"><link rel="prefetch" href="/Notebook/assets/js/63.db776fb0.js"><link rel="prefetch" href="/Notebook/assets/js/64.5862c070.js"><link rel="prefetch" href="/Notebook/assets/js/65.a562da8c.js"><link rel="prefetch" href="/Notebook/assets/js/66.9428e6a9.js"><link rel="prefetch" href="/Notebook/assets/js/67.380c3893.js"><link rel="prefetch" href="/Notebook/assets/js/68.4a1d975a.js"><link rel="prefetch" href="/Notebook/assets/js/69.f72c1c2a.js"><link rel="prefetch" href="/Notebook/assets/js/7.f18c22e1.js"><link rel="prefetch" href="/Notebook/assets/js/70.081e9efc.js"><link rel="prefetch" href="/Notebook/assets/js/71.9628b6c9.js"><link rel="prefetch" href="/Notebook/assets/js/72.fd7c0d8b.js"><link rel="prefetch" href="/Notebook/assets/js/73.ade29c87.js"><link rel="prefetch" href="/Notebook/assets/js/74.9beb3002.js"><link rel="prefetch" href="/Notebook/assets/js/75.4a0d7566.js"><link rel="prefetch" href="/Notebook/assets/js/76.82cba373.js"><link rel="prefetch" href="/Notebook/assets/js/77.cbc62dec.js"><link rel="prefetch" href="/Notebook/assets/js/78.7f360c8b.js"><link rel="prefetch" href="/Notebook/assets/js/79.fa101a6c.js"><link rel="prefetch" href="/Notebook/assets/js/8.b60843f8.js"><link rel="prefetch" href="/Notebook/assets/js/80.eff15427.js"><link rel="prefetch" href="/Notebook/assets/js/81.6cb7b0db.js"><link rel="prefetch" href="/Notebook/assets/js/82.8301875b.js"><link rel="prefetch" href="/Notebook/assets/js/83.36e9eaed.js"><link rel="prefetch" href="/Notebook/assets/js/84.6dab4e8d.js"><link rel="prefetch" href="/Notebook/assets/js/85.2698a308.js"><link rel="prefetch" href="/Notebook/assets/js/86.ef360da8.js"><link rel="prefetch" href="/Notebook/assets/js/87.768ec866.js"><link rel="prefetch" href="/Notebook/assets/js/88.ab9a859f.js"><link rel="prefetch" href="/Notebook/assets/js/89.d7a10705.js"><link rel="prefetch" href="/Notebook/assets/js/9.e93336f2.js"><link rel="prefetch" href="/Notebook/assets/js/90.ffb88a3d.js"><link rel="prefetch" href="/Notebook/assets/js/91.196c3e62.js"><link rel="prefetch" href="/Notebook/assets/js/92.c6c9f350.js"><link rel="prefetch" href="/Notebook/assets/js/93.4a2bfcd4.js"><link rel="prefetch" href="/Notebook/assets/js/94.5e133456.js"><link rel="prefetch" href="/Notebook/assets/js/95.90e64ed0.js"><link rel="prefetch" href="/Notebook/assets/js/96.e7faab2f.js"><link rel="prefetch" href="/Notebook/assets/js/97.5369d09a.js"><link rel="prefetch" href="/Notebook/assets/js/98.b3ce3ca9.js"><link rel="prefetch" href="/Notebook/assets/js/99.00453fa5.js">
    <link rel="stylesheet" href="/Notebook/assets/css/0.styles.8f4327af.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/Notebook/" class="home-link router-link-active"><!----> <span class="site-name">Naluduo's Notebook</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/Notebook/dailyRecord/" class="nav-link">
  📝日常记录
</a></div><div class="nav-item"><a href="/Notebook/blogs/" class="nav-link">
  📖文章合集
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="开发者" class="dropdown-title"><span class="title">开发者</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Notebook/frontend-web/" class="nav-link">
  💻大前端
</a></li><li class="dropdown-item"><!----> <a href="/Notebook/web-framework/" class="nav-link">
  🐂web 框架
</a></li><li class="dropdown-item"><!----> <a href="/Notebook/rethink/" class="nav-link">
  🤔复盘
</a></li><li class="dropdown-item"><h4>
          ️️🧘算法修炼
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Notebook/understand-the-computer/" class="nav-link">
  理解计算机
</a></li><li class="dropdown-subitem"><a href="/Notebook/algorithm/dataStructure.html" class="nav-link">
  数据结构
</a></li><li class="dropdown-subitem"><a href="/Notebook/algorithm/algorithm.html" class="nav-link">
  算法分类
</a></li><li class="dropdown-subitem"><a href="/Notebook/dataBase/index.html" class="nav-link">
  数据库
</a></li></ul></li><li class="dropdown-item"><!----> <a href="/Notebook/devops/" class="nav-link">
  ☁️运维
</a></li><li class="dropdown-item"><!----> <a href="/Notebook/test/" class="nav-link">
  🚬测试
</a></li><li class="dropdown-item"><!----> <a href="/Notebook/gis/" class="nav-link">
  🌍GIS
</a></li><li class="dropdown-item"><!----> <a href="/Notebook/tools/" class="nav-link">
  ️️🖱️工具
</a></li><li class="dropdown-item"><!----> <a href="/Notebook/network/" class="nav-link">
  ️️🐛网络工程
</a></li><li class="dropdown-item"><!----> <a href="/Notebook/game-development/" class="nav-link">
  ️️🎮游戏开发
</a></li><li class="dropdown-item"><!----> <a href="/Notebook/programming-language/" class="nav-link">
  🚶编程语言
</a></li><li class="dropdown-item"><!----> <a href="/Notebook/programming-paradigm/" class="nav-link">
  编程范式
</a></li></ul></div></div><div class="nav-item"><a href="/Notebook/lint/" class="nav-link">
  ✔️编码规范&amp;协同开发
</a></div><div class="nav-item"><a href="/Notebook/math/" class="nav-link">
  𝜋数学
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="设计" class="dropdown-title"><span class="title">设计</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Notebook/design/" class="nav-link">
  🖌️UI
</a></li></ul></div></div><div class="nav-item"><a href="/Notebook/bookmark/" class="nav-link">
  🏷书签整理
</a></div><div class="nav-item"><a href="http://shooterblog.site/Learn-JS-Demo/%E5%89%8D%E7%AB%AF%E7%9F%A5%E8%AF%86%E5%9B%BE%E8%B0%B1/index.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  📖知识脑图
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="http://www.jecyu.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  🔧个人博客
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="🔗Github" class="dropdown-title"><span class="title">🔗Github</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/Jecyu" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Jecyu github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://naluduo233.github.io/language-learning/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  英语学习
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://naluduo233.github.io/Fe-Auto-Testing/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  前端自动化测试
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://naluduo233.github.io/JS-Event-Loop/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  JS 事件循环机制
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://naluduo233.github.io/Web-Performance-Optimization/reference/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  微谈 Web 前端性能优化
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/Notebook/dailyRecord/" class="nav-link">
  📝日常记录
</a></div><div class="nav-item"><a href="/Notebook/blogs/" class="nav-link">
  📖文章合集
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="开发者" class="dropdown-title"><span class="title">开发者</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Notebook/frontend-web/" class="nav-link">
  💻大前端
</a></li><li class="dropdown-item"><!----> <a href="/Notebook/web-framework/" class="nav-link">
  🐂web 框架
</a></li><li class="dropdown-item"><!----> <a href="/Notebook/rethink/" class="nav-link">
  🤔复盘
</a></li><li class="dropdown-item"><h4>
          ️️🧘算法修炼
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Notebook/understand-the-computer/" class="nav-link">
  理解计算机
</a></li><li class="dropdown-subitem"><a href="/Notebook/algorithm/dataStructure.html" class="nav-link">
  数据结构
</a></li><li class="dropdown-subitem"><a href="/Notebook/algorithm/algorithm.html" class="nav-link">
  算法分类
</a></li><li class="dropdown-subitem"><a href="/Notebook/dataBase/index.html" class="nav-link">
  数据库
</a></li></ul></li><li class="dropdown-item"><!----> <a href="/Notebook/devops/" class="nav-link">
  ☁️运维
</a></li><li class="dropdown-item"><!----> <a href="/Notebook/test/" class="nav-link">
  🚬测试
</a></li><li class="dropdown-item"><!----> <a href="/Notebook/gis/" class="nav-link">
  🌍GIS
</a></li><li class="dropdown-item"><!----> <a href="/Notebook/tools/" class="nav-link">
  ️️🖱️工具
</a></li><li class="dropdown-item"><!----> <a href="/Notebook/network/" class="nav-link">
  ️️🐛网络工程
</a></li><li class="dropdown-item"><!----> <a href="/Notebook/game-development/" class="nav-link">
  ️️🎮游戏开发
</a></li><li class="dropdown-item"><!----> <a href="/Notebook/programming-language/" class="nav-link">
  🚶编程语言
</a></li><li class="dropdown-item"><!----> <a href="/Notebook/programming-paradigm/" class="nav-link">
  编程范式
</a></li></ul></div></div><div class="nav-item"><a href="/Notebook/lint/" class="nav-link">
  ✔️编码规范&amp;协同开发
</a></div><div class="nav-item"><a href="/Notebook/math/" class="nav-link">
  𝜋数学
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="设计" class="dropdown-title"><span class="title">设计</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Notebook/design/" class="nav-link">
  🖌️UI
</a></li></ul></div></div><div class="nav-item"><a href="/Notebook/bookmark/" class="nav-link">
  🏷书签整理
</a></div><div class="nav-item"><a href="http://shooterblog.site/Learn-JS-Demo/%E5%89%8D%E7%AB%AF%E7%9F%A5%E8%AF%86%E5%9B%BE%E8%B0%B1/index.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  📖知识脑图
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="http://www.jecyu.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  🔧个人博客
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="🔗Github" class="dropdown-title"><span class="title">🔗Github</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/Jecyu" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Jecyu github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://naluduo233.github.io/language-learning/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  英语学习
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://naluduo233.github.io/Fe-Auto-Testing/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  前端自动化测试
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://naluduo233.github.io/JS-Event-Loop/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  JS 事件循环机制
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://naluduo233.github.io/Web-Performance-Optimization/reference/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  微谈 Web 前端性能优化
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav>  <!----> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="程序员内功-进程与线程、协程"><a href="#程序员内功-进程与线程、协程" class="header-anchor">#</a> 程序员内功——进程与线程、协程</h1> <p>头脑风暴：</p> <ul><li>需求延伸解决方案：进程-线程-协程</li> <li>控制流与逻辑流</li> <li>指令执行</li> <li>生产者与消费者模式</li></ul> <p>目标读者</p> <p>文章大纲</p> <ul><li>CPU 计算</li> <li>进程与线程</li> <li>为什么要用多线程</li> <li>多线程一定比单线程要快吗？
<ul><li>什么时候使用多线程</li> <li>什么时候使用用单线程</li></ul></li> <li>如果采用单线程，要如何提效
<ul><li>js 单线程如何提效（事件驱动）</li> <li>redis 单线程如何提效</li></ul></li> <li>比线程更小的执行单位：协程</li></ul> <h2 id="前言"><a href="#前言" class="header-anchor">#</a> 前言</h2> <p>运行速率 CPU &gt; 内存 &gt; 硬盘</p> <p>现代操作系统（Window，macOS，Linux）都可以执行多任务。多任务就是同时运行多个任务，例如：</p> <p>CPU 执行代码都是一条条顺序执行的，但是，<u>即使是单核 CPU，也可以同时运行多个任务。因为操作系统执行多任务实际上就是让 CPU 对多个任务轮流交替执行。</u></p> <h2 id="cpu-计算任务"><a href="#cpu-计算任务" class="header-anchor">#</a> CPU 计算任务</h2> <h2 id="进程与线程"><a href="#进程与线程" class="header-anchor">#</a> 进程与线程</h2> <p>在计算机中，我们把一个任务称为一个进程，浏览器就是一个进程，视频播放器是另一个进程，类似的，音乐播放器和 Word 都是进程。</p> <p>进程和线程的关系就是：一个进程可以包含一个或多个线程，但至少会有一个线程，一个主线程。</p> <p>多线程切换成本比多进程切换成本要低。</p> <h3 id="进程和线程之间的关系"><a href="#进程和线程之间的关系" class="header-anchor">#</a> 进程和线程之间的关系</h3> <h4 id="进程中的任意一线程执行出错，都会导致整个进程的崩溃。"><a href="#进程中的任意一线程执行出错，都会导致整个进程的崩溃。" class="header-anchor">#</a> 进程中的任意一线程执行出错，都会导致整个进程的崩溃。</h4> <h4 id="线程之间共享进程中的数据"><a href="#线程之间共享进程中的数据" class="header-anchor">#</a> 线程之间共享进程中的数据</h4> <p><img src="/Notebook/assets/img/2020-06-19-12-46-11-multiple-thread-in-process.f57d3de7.png" alt=""></p> <p>因此如果线程 A 和线程 B 同时操作某一块数据的话，有必要同步锁住其中一个。例如浏览器渲染进程的 JS 线程与渲染线程。</p> <h4 id="当一个进程关闭之后，操作系统就会回收进程所占用的内存"><a href="#当一个进程关闭之后，操作系统就会回收进程所占用的内存" class="header-anchor">#</a> 当一个进程关闭之后，操作系统就会回收进程所占用的内存</h4> <h4 id="进程之间的内容相互隔离"><a href="#进程之间的内容相互隔离" class="header-anchor">#</a> 进程之间的内容相互隔离</h4> <h3 id="浏览器历史架构回顾"><a href="#浏览器历史架构回顾" class="header-anchor">#</a> 浏览器历史架构回顾</h3> <p>浏览器架构变迁</p> <p>单进程、单线程</p> <ul><li>不稳定</li> <li>不流畅</li> <li>安全</li></ul> <p>多进程</p> <p>目前多进程</p> <ul><li>浏览器进程</li> <li>渲染进程</li> <li>GPU 进程（目前 chrome 无论是否 3D，都用 GPU 进程 进行页面渲染。）</li> <li>网络进程</li> <li>插件进程</li></ul> <p>多进程</p> <ul><li>更高的资源占用。</li> <li>更复杂的体系架构</li></ul> <h3 id="多线程"><a href="#多线程" class="header-anchor">#</a> 多线程</h3> <p><img src="/Notebook/assets/img/2020-07-02-20-59-16-multiple-thread.6039bb4f.png" alt=""></p> <p>Java 语言内置了多线程支持：一个 Java 程序实际上是一个 （虚拟机）JVM 进程，JVM 进程用一个主线程来执行 <code>main()</code> 方法，在 <code>main()</code> 方法内部，我们又可以启动多个线程。此外，JVM 还有负责垃圾回收的其他工作线程等。</p> <p><img src="/Notebook/assets/img/2020-06-19-10-44-43-java-thread.a565b47e.png" alt=""></p> <p>java.lang.Thread 是个表示线程的类，它有启动线程、连接线程和让线程闲置的方法（这里列出重要的几个）。</p> <p>当有超过一个以上的<code>执行空间</code>时，看起来会像是有好几件事同时发生。实际上，只有真正的多处理器系统能够同时执行好几件事情，但使用 Java 的线程可以让它看起来好像同时都在执行中。也就是说，<u>执行动作可以在执行空间非常快速地来回切换，因此你会感觉到每项任务都在执行。</u></p> <p>即使是多核 CPU，因为通常任务的数量远远多于 CPU 的核数，所以任务也是交替执行的。也就是说是并发，而不是并行计算。</p> <h3 id="实现多线程"><a href="#实现多线程" class="header-anchor">#</a> 实现多线程</h3> <p>线程是独立的线程，它代表独立的执行空间。每个 Java 应用程序会启动一个主线程——将 <code>main()</code> 放在它自己执行空间的最开始处。
要记得 Java 也只是个在底层操作系统上执行的进程。一旦轮到 Java 执行的时候，Java 虚拟机实际上会执行什么？哪个字节码会被执行？答案就是目前执行空间最上面的会被执行！在 100 个毫秒内，目前执行程序代码可能会被切换到不同空间上的不同方法内。</p> <p>每个 Thread 需要一个任务来执行，一个可以放在执行空间的任务。实现多任务计算。</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Main</span> <span class="token punctuation">{</span>
	<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">new</span> <span class="token class-name">Thread1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">new</span> <span class="token class-name">Thread2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;back in main&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

<span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">Thread1</span> <span class="token keyword">extends</span> <span class="token class-name">Thread</span> <span class="token punctuation">{</span>
  <span class="token annotation punctuation">@Override</span>
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Thread-1: running...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Thread2</span> <span class="token keyword">extends</span> <span class="token class-name">Thread</span> <span class="token punctuation">{</span>
  <span class="token annotation punctuation">@Override</span>
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Thread-2: running...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p>虽然是多线程执行，但是由于要执行的任务多，导致线程多于 CPU 的数量，因此还需要有<code>线程调度器</code>(scheduler)的出现，来处理线程的执行问题。</p> <p>线程调度器会决定哪个线程从等待状况中被挑出来运行，以及何时把哪个线程送回等待被执行的状态。它会决定某个线程要运行多久，当线程被踢出时，调度器也会指定线程要回去等待下一个机会或者是暂时地堵塞。</p> <p>比如，浏览器的渲染进程中，不能让 JS 线程一直在执行，在它执行完一个宏任务后，就阻塞它（locked）（如果这个宏任务太久了，就有必要开启多个 worker 线程了），让渲染线程来绘制画面。</p> <p>两个线程就开始同时运行了，并且由操作系统调度，程序本身无法确定线程的调度顺序。要模拟并发执行的效果，可以让线程睡眠。</p> <h3 id="多线程的并发问题"><a href="#多线程的并发问题" class="header-anchor">#</a> 多线程的并发问题</h3> <p><code>并行性（concurrency）</code>问题会引发<code>竞态状态（condition）</code>。竞争状态会引发数据的损毁。</p> <p>这一切都来自于可能发生的一种状况，两个或两个以上的线程存取单一对象的数据。也就是说两个不同执行空间上的方法都在堆上对同一个对象执行 <code>getter</code> 或 <code>setter</code>。</p> <p>两个线程各自认为自己是宇宙的中心，只关心自己的任务。因为线程会被打入可执行状态，此时基本上是昏迷过去的，当它回到执行中的状态时，根本不知道自己曾经不省人事。</p> <h4 id="加锁"><a href="#加锁" class="header-anchor">#</a> 加锁</h4> <p>应用：单例模式（如果多个线程读取，会 new 的时候有问题）</p> <h2 id="为什么要用多线程"><a href="#为什么要用多线程" class="header-anchor">#</a> 为什么要用多线程</h2> <p><u>使用多线程的最大原因是因为单线程只会映射到一个 CPU 上，而多线程会映射到多个 CPU 上。</u>对于多 CPU 而言，是最大限度地利用 CPU 资源。现今，新出的电脑几乎都是两核以上的了。</p> <p>对于在单核 CPU 采用多线程的话，不会提供程序的执行速度，因为线程切换需要消耗时间，但对于用户来说，可以减少用户的响应时间。比如要执行一个网络任务，单线程需要一直在等待中，这是 CPU 不能做其他事情。</p> <p>至于浏览器所说的事件驱动，这也是浏览器渲染进程的<code>事件触发线程</code>合作把事件添加进任务队列 ，才能使 JS 单线程提取能够来异步执行请求任务（但是如果这个异步请求事件触发频率很高，那么 <code>JS 引擎单线程</code>还是会影响阻塞 <code>渲染线程</code>，就会导致有问题，才会有 <code>WebWorker</code> 处理。至于长轮询，可以使用 socket 来处理，服务端推送信息。</p> <p>创建 Worker 时，JS 引擎向浏览器申请开一个<code>子线程</code>（子线程是浏览器开的，完全受<code>主线程</code>控制，而且不能操作 DOM）。JS 引擎线程与 worker 线程间通信通过特定的方式通信（postMessage API，需要通过序列号对象来与线程交互特定的数据）。）</p> <p>Java 本身支持多线程，对于不支持多线程的 JS 也可以向浏览器申请子线程来做非常耗时的工作如解码视频。而 JS 引擎是单线程的，这一点的本质仍然未改变，Worker 可以理解是浏览器给 JS 引擎开的外挂，专门用来解决那些大量计算问题。</p> <p>目前 Web Worker 有：</p> <ul><li>Service Worker ，需要支持 https 协议。</li> <li>WebWorker</li> <li>SharedWorker</li></ul> <h2 id="多线程一定比单线程跑得快吗？"><a href="#多线程一定比单线程跑得快吗？" class="header-anchor">#</a> 多线程一定比单线程跑得快吗？</h2> <p>多线程会缓慢的原因：上下文切换、创建线程开销。</p> <p>首先单线程不会切换，这样它一直在执行这个线程照道理不是更快吗？但是就没有很好地利用多核处理器的优势了，而是有时候我们不想计算机一直执行某个计算任务，应该在 A 任务。如果 java 多线程在单核计算机里又是如何被对待呢？（浏览器渲染进程：JS 语言没有支持多线程，JS 单线程通过事件驱动来处理，关联了任务队列。）</p> <p>Java 多线程编程的特点又在于：</p> <ul><li>多线程模型是 Java 程序最基本的并发模型；</li> <li>后续读写网络 、数据库、Web 开发等都依赖 Java 多线程基础。</li></ul> <h2 id="如果采用单线程，要如何提效"><a href="#如果采用单线程，要如何提效" class="header-anchor">#</a> 如果采用单线程，要如何提效</h2> <h3 id="为什么-javascript-是单线程？"><a href="#为什么-javascript-是单线程？" class="header-anchor">#</a> 为什么 JavaScript 是单线程？</h3> <p>JavaScript 语言的一大特点就是单线程，也就是说，同一个时间只能做一件事。那么，为什么 JavaScript 不能有多个线程呢？这样能提高效率啊。</p> <p>JavaScript 的单线程，与它的用途有关。<u>作为浏览器脚本语言，JavaScript s 的主要用途是与用户互动，以及操作 DOM。这决定了它只能是单线程，否则会带来很复杂的同步问题。</u>比如，假定 JavaScript 同时有两个线程，一个线程在某个 DOM 节点上添加内容，另一个线程删除了这个节点，这时浏览器应该以哪个线程为准？</p> <p>所以，为了避免复杂性，从一诞生，JavaScript 只能运行在渲染进程的主线程上，从而说 JavaScript 是单线程。这已经成了这门语言的核心特征，将来也不会改变。</p> <p>为了利用多核 CPU 的计算能力，HTML5 提出 <code>Web Worker</code> 标准，允许 JavaScript 脚本创建多个线程，<u>但是子线程完全受主线程控制，且不得操作 DOM</u>。所以，这个新标准并没有改变 JavaScript 单线程的本质。</p> <p>创建 Worker 时，JS 引擎向浏览器申请开一个子线程（子线程是浏览器开的，完全受主线程控制，而且不能操作 DOM）
JS 引擎线程与 worker 线程间通过特定的方式通信（postMessage API，需要通过序列化对象来与线程交互特定的数据）</p> <h4 id="浏览器主线程就是-js-引擎线程吗？"><a href="#浏览器主线程就是-js-引擎线程吗？" class="header-anchor">#</a> 浏览器主线程就是 js 引擎线程吗？</h4> <p>浏览器主线程就是 js 执行的线程的，可以在 js 引擎线程中编写 Web Worker 申请线程。</p> <p>The main thread is where a browser processes user events and paints. By default, the browser uses a single thread to run all the JavaScript in your page, as well as to perform layout, reflows, and garbage collection. This means that long-running JavaScript functions can block the thread, leading to an unresponsive page and a bad user experience.</p> <p>Unless intentionally using a web worker, such as a service worker, <strong>JavaScript runs on the main thread, so it's easy for a script to cause delays in event processing or painting.</strong> The less work required of the main thread, the more that thread can respond to user events, paint, and generally be responsive to the user.</p> <ul><li><a href="https://developer.mozilla.org/en-US/docs/Glossary/Main_thread#:~:text=The%20main%20thread%20is%20where%20a%20browser%20processes%20user%20events%20and%20paints.&amp;text=Unless%20intentionally%20using%20a%20web,in%20event%20processing%20or%20painting." target="_blank" rel="noopener noreferrer">Main thread<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <h3 id="在线程运行过程中处理新任务"><a href="#在线程运行过程中处理新任务" class="header-anchor">#</a> 在线程运行过程中处理新任务</h3> <p>并不是搜有的任务都是在执行之前就安排好的，大部分情况下，<code>刷新的任务是在线程运行过程中产生的</code>。</p> <p>要想在线程运行过程中，能接收并执行新的任务，就需要采用<code>事件循环机制</code>。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>int <span class="token function">GetInput</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  int input_number <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  cout<span class="token operator">&lt;&lt;</span><span class="token string">&quot; 请输入一个数：&quot;</span><span class="token punctuation">;</span>
  cin<span class="token operator">&gt;&gt;</span>input_number<span class="token punctuation">;</span>
  <span class="token keyword">return</span> input_number<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 主线程（Main Thread）</span>
<span class="token keyword">void</span> <span class="token function">MainThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token punctuation">;</span><span class="token punctuation">;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    int first_num <span class="token operator">=</span> <span class="token function">GetInput</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    int second_num <span class="token operator">=</span> <span class="token function">GetInput</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    result_num <span class="token operator">=</span> first_num <span class="token operator">+</span> second_num<span class="token punctuation">;</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;最终计算的值为:%d&quot;</span><span class="token punctuation">,</span> result_num<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p><img src="/Notebook/assets/img/2020-07-02-14-09-53-event-loop.45e2bcc9.png" alt=""></p> <ul><li>引入循环机制，具体实现方式是在线程语句最后添加了一个 for 循环语句，线程会一直循环执行</li> <li>引入了事件，可以在线程运行的过程中，等待用户输入的数字，等待过程中线程处于暂停状态，一旦接收到用户输入的信息，那么线程就会被激活，然后执行相加运算，最后输出结果。</li></ul> <p>判断是否有事件发生触发新的任务，激活线程执行。</p> <h3 id="处理其他线程发送过来的任务"><a href="#处理其他线程发送过来的任务" class="header-anchor">#</a> 处理其他线程发送过来的任务</h3> <p>事件循环只是解决了线程内部的任务问题，如果另外一个线程想让主线程执行一个任务，就需要用到<code>消息队列</code>。</p> <p><img src="/Notebook/assets/img/2020-06-19-16-48-43-messager-event-loop.dec753b0.png" alt=""></p> <p>注：这里的 IO 线程包括（事件触发线程、异步请求线程等）？</p> <p>通过消息队列，我们实现了线程之间的消息通信。</p> <p>例如一个鼠标点击事件，通过<code>事件触发线程</code>发送消息给主线程的<code>消息队列</code>，主线程执行的任务都全部从消息队列中获取。所以如果有其他线程想要发送任务让主线程去执行，只需要将任务添加到该消息队列中就可以了</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>Task clickTask<span class="token punctuation">;</span>
task_queue.pushTask<span class="token punctuation">(</span>clickTask<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="处理其他进程发送过来的任务"><a href="#处理其他进程发送过来的任务" class="header-anchor">#</a> 处理其他进程发送过来的任务</h3> <p>通过消息队列，我们实现了线程之间的消息同学。在 Chrome 中，跨进程之间的任务也是频繁发生的，那么如何处理其他进程发送过来的任务？</p> <p><img src="/Notebook/assets/img/2020-06-20-19-49-45-process-communicate.a6ba5feb.png" alt=""></p> <h3 id="消息队列中的任务类型"><a href="#消息队列中的任务类型" class="header-anchor">#</a> 消息队列中的任务类型</h3> <p>内部消息类型，如输入事件（鼠标滚动、点击、移动）、微任务、文件读写、WebSocket、JavaScript 定时器等。</p> <p>除此之外，消息队列中还包含了很多与页面相关的事件，如 JavaScript 执行、解析 DOM、样式计算、布局计算、CSS 动画等。</p> <p>以上这些事件都是在主线程中执行的，所以在编写 Web 应用时，你还需要衡量这些事件所占用的时长，并想办法解决单个任务占用主线程过久的问题。</p> <h4 id="gui-渲染线程与-js-引擎线程互斥"><a href="#gui-渲染线程与-js-引擎线程互斥" class="header-anchor">#</a> GUI 渲染线程与 JS 引擎线程互斥</h4> <p>因为 JS 引擎可以修改 DOM 树，那么如果 JS 引擎在执行修改了 DOM 结构的同时，GUI 线程也在渲染页面，那么这样就会导致渲染线程获取的 DOM 的元素信息可能与 JS 引擎操作 DOM 后的结果不一致。为了防止这种现象，GUI 线程与 JS 线程需要设计为互斥关系，当 JS 引擎执行的时候，GUI 线程需要被冻结，但是 GUI 的渲染会被保存在一个队列当中，等待 JS 引擎空闲的时候执行渲染。
由此也可以推出，<u>如果 JS 引擎正在进行 CPU 密集型计算，那么 JS 引擎将会阻塞，导致主线程执行的这个 JS 任务长时间不空闲，</u>导致渲染进程一直不能执行渲染，页面就会看起来卡顿卡顿的，渲染不连贯，所以，要尽量避免 JS 执行时间过长。</p> <h4 id="js-引擎线程与事件触发线程、定时触发器线程、异步-h-ttp-请求线程"><a href="#js-引擎线程与事件触发线程、定时触发器线程、异步-h-ttp-请求线程" class="header-anchor">#</a> JS 引擎线程与事件触发线程、定时触发器线程、异步 H TTP 请求线程</h4> <p>JS 执行任务也是在主线程，那其他线程在干嘛？ JS 单线程用来做什么的？</p> <p><strong>主线程就是 JS 执行所在的线程</strong></p> <p>事件触发线程、定时触发器线程、异步 HTTP 请求线程（还包括 GUI 线程的事件回调比如 Composite Layers。）三个线程有一个共同点，那就是使用回调函数的形式，当满足了特定的条件，这些回调函数会被执行。<strong>这些回调函数被浏览器内核理解成事件，发送消息给主线程，添加进去<code>任务队列</code></strong>，遇到需要执行的 JS 任务，则等待 JS 引擎空闲执行。（JS 引擎线程本身也维护了自己的任务队列。</p> <p><strong>主线程这里相当于是一个调度的作用</strong>，执行 JavaScript 时，会让 JS 线程来做这个工作。只不过它相当于一个入口，就像 Java 中的 <code>main()</code> 线程一样。例如事件触发线程会在异步网络请求完成后，会把这个新任务提交到主线程，主线程执行后就会调用 JS 线程来执行回调函数，如果这个执行 JS 任务过久的话，就会阻塞页面的渲染，Chrome 锁定了 DOM。GUI 更新会被保存在一个队列中等到 JS 引擎空闲时立即被执行，因此才会有 worker 申请子线程。</p> <p><img src="/Notebook/assets/img/2020-10-22-08-50-15.d07b4b43.png" alt=""></p> <p>现在可以在主线程，通过 worker 申请子线程，但是子线程是不能操作 DOM 的。</p> <p>渲染主线程会频繁接收到来自于 IO 线程的一些任务，接收到这些任务之后，渲染进程就需要着手处理，比如接收到资源加载完成的消息后，渲染进程就要着手进行 DOM 解析了；接收到鼠标点击的消息后，渲染主线程就要开始执行相应的 JavaScript 脚本来处理该点击事件。</p> <p><img src="/Notebook/assets/img/2020-10-22-08-52-54.691e41d8.png" alt=""></p> <p>从图中可以看出，我们点击展开了 Main 这个项目，其记录了主线程执行过程中的所有任务。图中灰色的就是一个个任务，每个任务下面还有子任务，其中的 Parse HTML 任务，是把 HTML 解析为 DOM 的任务。值得注意的是，在执行 Parse HTML 的时候，如果遇到 JavaScript 脚本，那么会暂停当前的 HTML 解析而去执行 JavaScript 脚本。</p> <p>执行完 CompoisiteLayer 任务后，主线程就会通知 GUI 线程去绘制渲染。</p> <h3 id="消息队列机制并不是太灵活，为了适应效率和实时性，引入了微任务"><a href="#消息队列机制并不是太灵活，为了适应效率和实时性，引入了微任务" class="header-anchor">#</a> 消息队列机制并不是太灵活，为了适应效率和实时性，引入了微任务</h3> <p>通常我们把消息队列中的任务称为宏任务，每个宏任务中都包含了一个微任务队列，在执行宏任务的过程中，如果 DOM 有变化，那么就会将该变化添加到微任务列表中，这样就不会影响到宏任务的继续执行，因此也就解决了执行效率的问题。</p> <p>等宏任务中的主要功能都直接完成之后，这时候，渲染引擎并不着急去执行下一个宏任务，而是执行当前宏任务中的微任务，因为 DOM 变化的事件都保存在这些微任务队列中，这样也就解决了<code>实时性</code>问题。</p> <p>主线程执行完一个宏任务后，就会进行渲染线程执行绘制画面了。</p> <h2 id="协程"><a href="#协程" class="header-anchor">#</a> 协程</h2> <p>跟 setTimeout 有点类似。</p> <div class="language-cs line-numbers-mode"><pre class="language-cs"><code><span class="token keyword">using</span> <span class="token namespace">System</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Collections</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Collections<span class="token punctuation">.</span>Generic</span><span class="token punctuation">;</span>

<span class="token keyword">namespace</span> <span class="token namespace">Basic</span>
<span class="token punctuation">{</span>
  <span class="token keyword">class</span> <span class="token class-name">MainClass</span>
  <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> args<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      <span class="token class-name">IEnumerable<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">&gt;</span></span> numbers <span class="token operator">=</span> MainClass<span class="token punctuation">.</span><span class="token function">SomeNumbers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> number <span class="token keyword">in</span> numbers<span class="token punctuation">)</span>
      <span class="token punctuation">{</span>
        Console<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span>number<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot; &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name">IEnumerable<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">&gt;</span></span> <span class="token function">SomeNumbers</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 返回一个可枚举的类型，带有 Enumerator 属性</span>
    <span class="token punctuation">{</span>
      <span class="token keyword">yield</span> <span class="token keyword">return</span> <span class="token number">3</span><span class="token punctuation">;</span>
      <span class="token keyword">yield</span> <span class="token keyword">return</span> <span class="token number">5</span><span class="token punctuation">;</span>
      <span class="token keyword">yield</span> <span class="token keyword">return</span> <span class="token number">8</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><p>SomeNumbers 是一个简单的迭代器方法，里面分别用到了三次 <code>yield return</code> 语句。</p> <p>SomeNumbers 被调用的时候，其函数体并不会执行，而是给变量 numbers 赋值了一个 <code>IEnumberable&lt;int&gt;</code> 类型。</p> <p>每一次 <code>foreach</code> 循环执行的时候，<code>numbers</code> 的 <code>MoveNext</code> 方法会被调用到，<code>MoveNext</code> 方法会执行 <code>SomeNumbers</code> 方法内的语句，直到碰到 <code>yield return</code> 语句。</p> <p>当碰到 <code>yield return</code> 语句时，<code>SomeNumbers</code> 方法将终止执行，并将 <code>yield return</code> 的值赋给 <code>number</code>。但并不代表 <code>SomeNumbers</code> 方法以及 ing 全部执行完毕，等到<strong>下一次</strong> <code>foreach</code> 循环执行时，代码会从上一次返回的 <code>yield return</code> 语句<strong>之后</strong>开始继续执行，直到函数结束或者遇到下一个 <code>yield return</code> 语句为止。</p> <p>简而言之，<code>yield return</code> 的意义是返回一个值给 <code>foreach</code> 的每次迭代，然后<code>终止</code>迭代器方法的执行。等到下一次迭代时，迭代器方法会从<code>原来看的为止继续往下</code>运行。</p> <p>可以理解为迭代器方法 <code>SomeNumbers</code> 为一个生产者，<code>foreach</code> 循环的每次循环 <code>MoveNext</code> 是一个消费者。每一次循环往下移动一格，消费者便要向迭代器方法要一个值。所以，yield 在其中的意思应该是 <code>产出</code>的意思，而且是按需生产的意思。</p> <p><code>yield break</code> 则可以视为<code>终止产出</code> 的意思，即结束迭代器的迭代。</p> <h3 id="什么是-coroutine"><a href="#什么是-coroutine" class="header-anchor">#</a> 什么是 Coroutine</h3> <p>Coroutine 翻译过来就是协程，和线程 Threads 是两个完全不同的概念。（自己交出控制权）</p> <p>线程是完全异步的，在多核 CPU 上可以做到真正的并行。正是由于完全并行的自由，导致线程的编程特别麻烦。</p> <p>比如：A 线程在读取一个变量的值时，B 线程可能正在给这个变量重新赋值，导致 A 线程读到的值并不准确。为了保证一个变量同一时刻只有一个线程访问，需要给变量加上锁，当线程访问完毕后记得解锁。</p> <p><code>协程</code>则是线程中执行的一短代码，它并不能做到真正异步。协程的代码可以只执行其中一部分，然后<code>挂起</code>，等到未来一个<code>恰当时机</code>再从原来挂起的地方<code>继续向下执行</code>。</p> <p>这个可以联系上面提到的 <code>yield return</code> 语句，只执行一部分的代码，直到下一个 <code>yield return</code> 语句，然后挂起，直到恢复时接着之前的代码继续向下执行。</p> <p>在 Unity 中的协程就用到了 <code>yield return</code> 语句，只不过跟上述的简单 <code>foreach</code> 循环不同。<u>Unity 是在游戏的每一<code>帧</code>（frame）中去检查是否需要从挂起的地方恢复继续向下执行。</u></p> <h3 id="yield-return-null"><a href="#yield-return-null" class="header-anchor">#</a> yield return null</h3> <div class="language-cs line-numbers-mode"><pre class="language-cs"><code>
<span class="token keyword">using</span> <span class="token namespace">UnityEngine</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Collections</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CoroutineDemo01</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">MonoBehaviour</span></span>
<span class="token punctuation">{</span>
  <span class="token comment">// Use this for initialization</span>
  <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    <span class="token function">StartCoroutine</span><span class="token punctuation">(</span><span class="token function">ReturnNull</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;Start Ends&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// Update is called once per frame</span>
  <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;Update&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token return-type class-name">IEnumerator</span> <span class="token function">ReturnNull</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;ReturnNull Invoked&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;before yield return null&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">yield</span> <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
      <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;after yield return null&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><p>以上代码输出为：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>ReturnNull Invoked
before yield <span class="token builtin class-name">return</span> null
Start Ends
Update
Update
after yield <span class="token builtin class-name">return</span> null
before yield <span class="token builtin class-name">return</span> null
Update
after yield <span class="token builtin class-name">return</span> null
before yield <span class="token builtin class-name">return</span> null
Update
after yield <span class="token builtin class-name">return</span> null
before yield <span class="token builtin class-name">return</span> null
Update
after <span class="token punctuation">..</span>.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p><code>StartCoroutine</code> 函数启动了一个协程方法 <code>ReturnNull</code>。</p> <p>可以看到 <code>ReturnNull</code> 的函数体在 <code>StartCoroutine</code> 后立刻被执行，于是输出；饿 <code>ReturnNull Invoked</code> 和 <code>before yield return null</code>。之后便输出 <code>Start Ends</code>，并没有输出 <code>after yield return null</code>，说明代码在此终端。根据 yield 的用法，我们知道这只是一次暂时的挂起，在未来某个时候 <code>after yield return null</code> 将会输出。</p> <p>紧接着输出了 <code>Update</code> ，这是我们的第一帧。后续的输出则构成了一个三句话的无限循环：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>Update
after yield return null
before yield return null
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>为什么会是这样的输出呢？要理解这个之前，我们首先需要知道 Unity 在一帧中都干了些什么，而且它们是以怎样的顺序执行的。</p> <h3 id="unity-的时序"><a href="#unity-的时序" class="header-anchor">#</a> Unity 的时序</h3> <p><img src="/Notebook/assets/img/monobehaviour_flowchart.440bbf22.svg" alt=""></p> <p>以上是 Unity 一帧内做的事情，可以看到 <code>yield return null</code> 是在 <code>Update</code> 之后执行。</p> <p>现在我们来试着理解以上代码的输出过程。</p> <p>首先，第一帧的 Update 输出了一个 <code>Update</code>，因为协程是在 <code>Start</code> 函数里开始的，所以要在下一帧才能从挂起状态恢复。</p> <p>第二帧，从时序图可以看到，Mono 的 Update 函数先执行，所以会先输出一个 <code>Update</code>，然后协程被恢复运行。因为上一次协程是在 <code>yield return null</code> 被挂起的，所以协程会从它的下一句恢复，也就是 <code>print(&quot;after yield return null&quot;)</code>。意味代码处在一个无限循环中，所以 <code>print(&quot;before yield return null&quot;)</code> 会紧接着被执行到。接下来又执行到 <code>yield return null</code>，此时协程会再次被挂起，直到下一帧 Update 之后再恢复。</p> <p>我们稍微总结一下：<code>yield return null</code> 是协程的<code>挂起点</code>，即协程内的代码块执行到这里将被挂起（包括方法体的执行状态都被暂存起来）。它同时也是一个<code>恢复点</code>，即在下一帧 Update 之后，将会执行它的下一句代码，直到函数结束或者遇到下一个 <code>yield return null</code>。</p> <h3 id="其他的用法"><a href="#其他的用法" class="header-anchor">#</a> 其他的用法</h3> <h4 id="yield-break"><a href="#yield-break" class="header-anchor">#</a> yield break</h4> <p><code>yield break</code> 表示退出协程，即协程将不会从挂起点被恢复。在 <code>yield break</code> 之后的协程内的代码将都不会被执行到。</p> <p>我们可以用这个方式来彻底终止协程的运行。</p> <h4 id="startcoroutine-stopcoroutine"><a href="#startcoroutine-stopcoroutine" class="header-anchor">#</a> StartCoroutine &amp; StopCoroutine</h4> <p><code>StartCoroutine</code> 表示开始一段协程，它有两种方式：</p> <div class="language-cs line-numbers-mode"><pre class="language-cs"><code><span class="token keyword">public</span> <span class="token return-type class-name">Coroutine</span> <span class="token function">StartCoroutine</span><span class="token punctuation">(</span><span class="token class-name">IEnumerator</span> routine<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token return-type class-name">Coroutine</span> <span class="token function">StartCoroutine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> methodName<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">object</span></span> <span class="token keyword">value</span> <span class="token operator">=</span> n<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>一种是用 <code>IEnumerator</code> 对象启动，例如上例的 <code>ReturnNull()</code></p> <p>另一种是以协程名启动，例如上例的协程启动可以写成：<code>StartCoroutine(&quot;ReturnNull&quot;)</code></p> <p><code>StopCoroutine</code> 表示彻底终止一端协程，两种不同的启动方式，但必须与终止方式一一对应着：</p> <div class="language-cs line-numbers-mode"><pre class="language-cs"><code><span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">StopCoroutine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> methodName<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">StopCroutine</span><span class="token punctuation">(</span><span class="token class-name">IEnumerator</span> routine<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>因为 <code>StopCoroutine(string methodName)</code> 的方式的性能开销（字符串查找）会比 <code>StopCoroutine(IEnumerator routine)</code> 更高一些，且前者的开始方式只能给协程传递<code>一个</code>参数，所以我们一般会倾向于使用 <code>StartCoroutine(IEnumerator routine)</code> 来开启协程。</p> <p>不过，为了能使用 <code>StopCoroutine(IEnumerator routine)</code> 来终止协程运行，我们需要将开始协程的 <code>IEnumerator</code> 对象暂存起来。</p> <h4 id="yield-return-xxxx"><a href="#yield-return-xxxx" class="header-anchor">#</a> yield return xxxx</h4> <p>上述所说的 <code>yield return null</code> 是最简单的协程类型，即在每一帧 <code>Update</code> 之后恢复。</p> <p>在 Unity 中，还支持了其他的一些类型，举例如下：</p> <p><code>yield return new WaitForSeconds(1.5f)</code>，表示在 1.5 秒之后将协程恢复，从时序图中可以看到它的恢复也将在 Update 之后执行。</p> <p><code>yield return new WaitForEndOfFrame()</code>，表示在一帧的最后阶段将协程恢复，从时序图可以看到它的恢复将在一帧的最后执行，此时物理逻辑，游戏逻辑和渲染逻辑都已执行完毕。</p> <p><code>yield return new WaitForFixedUpdate()</code>，表示在物理引擎这一帧运算完毕后将协程恢复，从时序图可以看到它的恢复在物理运算的最后一步，在 FixedUpdate 之后执行。</p> <p><code>yield return new WWW(&quot;https://wuzhiwei.net/photo/photo1.jpg&quot;)</code>，表示通过 WWW 访问网址 <code>https://wuzhiwei.net/photo/photo1.jpg</code>，将图片下载完毕时将协程恢复。</p> <p><code>yield return StartCoroutine(routine)</code>，这是一种比较特殊的方式，即组合协程。即这个协程的恢复条件是 <code>routine</code> 这个协程的运行已经<code>彻底终止</code>。</p> <p>例如：</p> <div class="language-cs line-numbers-mode"><pre class="language-cs"><code><span class="token keyword">using</span> <span class="token namespace">UnityEngine</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Collections</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CoroutineDemo02</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">MonoBehaviour</span></span>
<span class="token punctuation">{</span>
  <span class="token comment">// Use this for initialization</span>
  <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    <span class="token function">StartCoroutine</span><span class="token punctuation">(</span><span class="token function">Test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// Update is called once per frame</span>
  <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>

  <span class="token punctuation">}</span>
  <span class="token keyword">private</span> <span class="token return-type class-name">IEnumerator</span> <span class="token function">Test</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    Debug<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span><span class="token string">&quot;Test Method Starts&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">yield</span> <span class="token keyword">return</span> <span class="token function">StartCoroutine</span><span class="token punctuation">(</span><span class="token function">Test2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    Debug<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span><span class="token string">&quot;Test Method Ends&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">private</span> <span class="token return-type class-name">IEnumerator</span> <span class="token function">Test2</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    Debug<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span><span class="token string">&quot;Test2 Starts&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name"><span class="token keyword">int</span></span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      Debug<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span><span class="token string">&quot;Before &quot;</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">yield</span> <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
      Debug<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span><span class="token string">&quot;After&quot;</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token operator">++</span>i<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br></div></div><p>输出如下：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>Test Method Starts
Test2 Starts
Before <span class="token number">0</span>
After <span class="token number">0</span>
Before <span class="token number">1</span>
After <span class="token number">1</span>
Before <span class="token number">2</span>
After <span class="token number">2</span>
Test Method Ends
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>只有当 <code>TestCoroutine</code> 中的 <code>i == 3</code> 时，<code>TestCoroutine</code> 这个协程将彻底终止，此时 <code>Test</code> 将被恢复，才输出了 <code>Test Method Ends</code></p> <h3 id="应用场景"><a href="#应用场景" class="header-anchor">#</a> 应用场景</h3> <h4 id="延时执行一段代码"><a href="#延时执行一段代码" class="header-anchor">#</a> 延时执行一段代码</h4> <div class="language-cs line-numbers-mode"><pre class="language-cs"><code><span class="token return-type class-name">IEnumerator</span> <span class="token function">WaitForDoSomeThing</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">yield</span> <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">WaitForSeconds</span><span class="token punctuation">(</span><span class="token number">1.5f</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">DoSomeThing</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><code>StartCoroutine(WaitForDoSomething())</code> 开启协程后，在过 1.5 秒 <code>DoSomeThing()</code> 方法将被执行到。因为遇到 <code>yield return</code>，协程会被挂起，1.5 秒后，将会从挂起点恢复，向下执行 <code>DoSomeThing()</code> 方法。</p> <h4 id="做进度的更新"><a href="#做进度的更新" class="header-anchor">#</a> 做进度的更新</h4> <p>比如下载一张图片：</p> <div class="language-cs line-numbers-mode"><pre class="language-cs"><code><span class="token return-type class-name">IEnumerator</span> <span class="token function">WaitForDownLoad</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token class-name">WWW</span> www <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">WWW</span><span class="token punctuation">(</span><span class="token string">&quot;https://edmullen.net/test/rc.jpg&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">!</span>www<span class="token punctuation">.</span>isDone<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token function">print</span><span class="token punctuation">(</span>www<span class="token punctuation">.</span>progress<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">yield</span> <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;photo ready!&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>我们在图片下载完成之前（间接不阻塞主线程，通过协程时间分片），我们可以在每一帧中更新图片下载的进度，从而可以更新 Loading 条之类的进度指示器来提示玩家。</p> <p>我们当然也可以在 <code>Update</code> 方法中来做这件事，这样可能更明显一点，但是有以下两个缺陷：</p> <ol><li>Update 每帧都会执行到，也就意味着 <code>www.isDone</code> 的条件判断会贯穿于整个游戏的生存周期，这样在图片下载完毕后会带来没必要的性能开销。（在协程中可以在图片下载完毕后，终止当前的协程。并且由于 www 不再被使用，会被垃圾回收）</li> <li>代码的聚合型不强，Update 里的逻辑会越来越多，而使用协程可以将逻辑内聚到协程内部。</li></ol> <p>加载场景：</p> <div class="language-cs line-numbers-mode"><pre class="language-cs"><code>
  <span class="token keyword">private</span> <span class="token return-type class-name">IEnumerator</span> <span class="token function">LoadScene</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> sceneNum<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    asyncOperation <span class="token operator">=</span> SceneManager<span class="token punctuation">.</span><span class="token function">LoadSceneAsync</span><span class="token punctuation">(</span><span class="token string">&quot;Level1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 不允许就啊这完毕自动切换场景，因为有时候加载太快了就看不到加载进度条 UI 效果</span>
    asyncOperation<span class="token punctuation">.</span>allowSceneActivation <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

    <span class="token comment">// 等待协程完全加载完毕，每次都会执行</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span>asyncOperation<span class="token punctuation">.</span>isDone <span class="token operator">&amp;&amp;</span> asyncOperation<span class="token punctuation">.</span>progress <span class="token operator">&lt;</span> <span class="token number">0.8f</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      <span class="token comment">// 执行到此语句时，程序会挂起，等待下一帧才会继续执行后面的代码</span>
      <span class="token keyword">yield</span> <span class="token keyword">return</span> asyncOperation<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>当 asyncOperation.isDone 后，不再有 yield 挂起状态，这个时候方法体内的数据都会被回收？</p> <h3 id="总结及注意点"><a href="#总结及注意点" class="header-anchor">#</a> 总结及注意点</h3> <ul><li>协程不是线程，不能做到真正异步。协程是运行在 Unity 主线程中的一段代码，它能被挂起，然后在<code>未来</code>的某个时刻从挂起的位置恢复执行。</li> <li><code>yield return &lt;expression&gt;</code> 格式，表示协程的挂起点和未来的恢复点，究竟具体什么样的未来（一帧之后或 n 秒后或者其他等等），取决于 <code>&lt;expression&gt;</code> 具体是什么。</li> <li><code>yield break</code> 格式，表示彻底退出协程，且其之后的协程代码将不会被执行到。</li> <li><code>WaitForSeconds</code> 会受到 <code>Time.timeScale</code> 的影响，当 <code>Time.timeScale</code> 为 0 时，协程将永远不会被恢复。如果一定要用真实时间可以用 <code>WaitForSecondRealtime</code>，它不会受到 <code>Time.timeScale</code> 的影响。</li></ul> <h2 id="小结"><a href="#小结" class="header-anchor">#</a> 小结</h2> <h2 id="参考资料"><a href="#参考资料" class="header-anchor">#</a> 参考资料</h2> <ul><li>协程
<ul><li><a href="https://blog.csdn.net/huang9012/article/details/38492937" target="_blank" rel="noopener noreferrer">Unity3D 协程介绍 以及 使用<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://mp.weixin.qq.com/s/57IERpGIlvRwYCh6vSbMDA" target="_blank" rel="noopener noreferrer">漫画：什么是协程？<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://www.zhihu.com/topic/19890065/top-answers" target="_blank" rel="noopener noreferrer">知乎协程话题<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://wuzhiwei.net/unity_coroutines/" target="_blank" rel="noopener noreferrer">对 Unity 中 Coroutines 的理解<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://docs.unity3d.com/cn/current/Manual/BestPracticeUnderstandingPerformanceInUnity3.html" target="_blank" rel="noopener noreferrer">协程<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://www.coolketang.com/static3D/5a7f0028ee920a0044544e4f.html" target="_blank" rel="noopener noreferrer"> 详解 Unity3D 中的协程（Coroutine）<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li> <li><a href="https://blog.poetries.top/browser-working-principle/guide/part1/lesson01.html#%E4%BB%80%E4%B9%88%E6%98%AF%E5%B9%B6%E8%A1%8C%E5%A4%84%E7%90%86" target="_blank" rel="noopener noreferrer">浏览器工作原理与实践<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://zhuanlan.zhihu.com/p/95005766" target="_blank" rel="noopener noreferrer">面试官：多线程一定比单线程跑得快吗？<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://blog.csdn.net/u013568373/article/details/93488554" target="_blank" rel="noopener noreferrer">多线程就一定比单线程快吗？<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://blog.csdn.net/BigJacky/article/details/51588956" target="_blank" rel="noopener noreferrer">多线程为什么比单线程快呢？<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>《Java 并发编程》</li> <li>《Head First Java》</li> <li><a href="https://segmentfault.com/a/1190000013083967#item-6-2" target="_blank" rel="noopener noreferrer">浅谈浏览器多进程与 JS 线程<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://cloud.tencent.com/developer/article/1393277" target="_blank" rel="noopener noreferrer">JavaScript 单线程与异步<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://blog.csdn.net/wd2014610/article/details/85291597" target="_blank" rel="noopener noreferrer">Java 主线程和其余线程的区别和实践（Main、Runnable、Thread）<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="">javascript 既然是单线程语言 ， 为什么会分主线程和消息线程(event loop) ?</a></li> <li><a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html" target="_blank" rel="noopener noreferrer">JavaScript 运行机制详解：再谈 Event Loop<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://www.infoq.cn/article/CS9-WZQlNR5h05HHDo1b" target="_blank" rel="noopener noreferrer">史上最全！图解浏览器的工作原理<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://mp.weixin.qq.com/s/jMPSkC7XdHc-v8_WslkBQA" target="_blank" rel="noopener noreferrer">高性能网络通信库中为何要将侦听 socket 设置成非阻塞的？<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://mp.weixin.qq.com/s?__biz=MzU2MTkwMTE4Nw==&amp;mid=2247487973&amp;idx=2&amp;sn=140004b0dfde45745091ab5c6522dcba&amp;scene=21#wechat_redirect" target="_blank" rel="noopener noreferrer">one thread one loop 程序的基本结构<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">3/1/2021, 12:17:15 PM</span></div></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/Notebook/assets/js/app.139a155b.js" defer></script><script src="/Notebook/assets/js/4.e8b70bd9.js" defer></script><script src="/Notebook/assets/js/27.23c0d0bb.js" defer></script>
  </body>
</html>
