# 统一认证中心

不知道你们公司的业务逻辑是什么，如果可以的话，最好的方案是统一用户中心。之前碰过类似的项目，最后都是统一使用这个方案。

也就是说，不过现在是系统 A,B,C 或者以后可能会 E,F,G 都统一使用一个用户中心来管理用户，如注册、登录。

统一了用户中心，其他就好办了：

合并用户数据，将三个系统中的用户合并起来；
更改三个系统的登录和注册入口，都链接到新的「统一的用户中心」。
否则后面随着系统的增多，同步各个系统之间用户数据，将难度倍增，复杂度会高到你想辞职。

头脑风暴
- 新建用户
- 删除用户
- 统一认证中心
- 业务系统
- 是否可以清空现有的业务库用户
- 重新构建
- 运维权限如何处理（考虑）
- 南宁国土空间一张图接入统一认证中心初步方案

## 对接目标

对业务系统进行改造，对接统一认证平台对业务系统进行改造，对接统一认证平台，实现如下主要目标：
1. 使用统一账号登入登出业务系统：
      用户可以使用通过统一账号登入，获取统一认证平台的用户基本信息。
2. 业务系统运维同步统一认证中心用户数据，进行个性化的权限分配。

## 接入流程

申请接入所需的客户端 id 和Secret，进行接口对接和单点登录功能验证，包括业务系统和统一认证中心系统。这个具体的接入流程由统一认证中心提供。
用户信息同步方案

## 问题分析

完成单点登录，我们便可以通过只登录一个账号，来访问不同系统，然而会遇到以下问题.
1. 通过 A 站登录的用户访问 B 站，在 B 站并没有真实用户，此时如果在 B站新建用户，则可能造成用户信息不全，或者数据冲突等问题。
2. AB 两站的用户数据如果属于同一用户，如何处理?
方案一：用户的用户名密码都统一放到认证中心，ABC系统不留，相当于在任意一个系统登录都是用的同一个用户名密码。这么做的话需要做用户关联和整合（例如在主站新建立一个表，用来同步管理子站用户信息）。
方案二：如果每个系统还是使用原本的用户名密码，那么认证中心就存各个系统的用户关联关系和登录状态。每个系统还是用原本的用户名和密码。这么做的话需要做用户关联。
考虑到方案二更加简单清晰，建议采用方案二，具体如下：
提供统一账户库，账户库主要由账号信息和用户基本信息等组成， 用于存储账户信息。其中账号信息包括用户账号（登录名）、密码、用于找回账号密码的手机号码或电子邮箱。
业务系统用户库：一般指用户信息库，由业务系统自行管理，主要存储描述用户基本信息及业务系统需要的个性化信息，其中用户基本信息可来自统一账户库（通过技术同步），业务系统所需的个性化信息由业务系统自行维护。
可能需要同步的情况
现有用户的合并
使用现有的用户
增删改用户信息
同步技术方案
根据定时同步还是实时同步，有两种方式：
接口同步
能做定时同步或者实时同步（用户看起来），实现起来较为灵活，但是要在项目和数据库代码中做操作，也比较复杂。需要通过对应的业务逻辑判断用户信息，对比并同步数据库的用户信息，如新增用户与修改用户信息
数据库同步（前提下，业务库与统一账户库能够连通）
只能做定时同步，相对较为简单，不需要在项目代码层做操作。数据库定时同步可通过定时任务完成，初步估计2-5天完成
统一认证中心（提供、支持）
1. 详细的统一身份认证平台接入指引，包括
	a. 统一安全中心系统基本概括说明
	b. 对接目标
	c. 认证的标准规范
	d. 业务系统对接内容
	e. 用户信息同步规则
	f. 接入及相关参数说明


  

